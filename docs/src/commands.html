
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>
            ModalEdit - Commands
        </title>
        <link rel="icon" type="image/icon" href="../images/favicon.svg" />
        <link rel="stylesheet" href="../dist/normal.css" />
        
    </head>
    <body data-syntax-highlight="monokai"
        data-theme="purple-rain">
        
        <div id="navbar">
            
    <div class="navmenu ">
        
    <div class="navitem " >
        <a class="title enabled" href="../index.html" >
            <img src="../images/escape.svg" />
            <span>ModalEdit</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://marketplace.visualstudio.com/items?itemName=johtela.vscode-modaledit" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-download" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M19 18a3.5 3.5 0 0 0 0 -7h-1a5 4.5 0 0 0 -11 -2a4.6 4.4 0 0 0 -2.1 8.4" />
            <path d="M12 13l0 9" />
            <path d="M9 19l3 3l3 -3" />
        </svg>
            <span>Download</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://github.com/johtela/vscode-modaledit" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
        </svg>
            <span>GitHub</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="../LICENSE.html" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-license" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M15 21h-9a3 3 0 0 1 -3 -3v-1h10v2a2 2 0 0 0 4 0v-14a2 2 0 1 1 2 2h-2m2 -4h-11a3 3 0 0 0 -3 3v11" />
            <path d="M9 7l4 0" />
            <path d="M9 11l4 0" />
        </svg>
            <span>License</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Syntax Highlight</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="coding-horror">
        <a   onclick="document.body.syntaxHighlight('coding-horror')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Coding Horror</span>
        </a>
        
    </div>
    <div class="navitem active" id="monokai">
        <a   onclick="document.body.syntaxHighlight('monokai')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Monokai</span>
        </a>
        
    </div>
    <div class="navitem " id="solarized-light">
        <a   onclick="document.body.syntaxHighlight('solarized-light')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Solarized Light</span>
        </a>
        
    </div>
    <div class="navitem " id="son-of-obsidian">
        <a   onclick="document.body.syntaxHighlight('son-of-obsidian')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Son of Obsidian</span>
        </a>
        
    </div>
    </div>
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Theme</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="blueberry">
        <a   onclick="document.body.theme('blueberry')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Blueberry</span>
        </a>
        
    </div>
    <div class="navitem " id="book-cover">
        <a   onclick="document.body.theme('book-cover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Book Cover</span>
        </a>
        
    </div>
    <div class="navitem " id="brownie">
        <a   onclick="document.body.theme('brownie')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Brownie</span>
        </a>
        
    </div>
    <div class="navitem " id="camouflage">
        <a   onclick="document.body.theme('camouflage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Camouflage</span>
        </a>
        
    </div>
    <div class="navitem " id="chocolate">
        <a   onclick="document.body.theme('chocolate')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Chocolate</span>
        </a>
        
    </div>
    <div class="navitem " id="greyhound">
        <a   onclick="document.body.theme('greyhound')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Greyhound</span>
        </a>
        
    </div>
    <div class="navitem " id="ice-age">
        <a   onclick="document.body.theme('ice-age')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ice Age</span>
        </a>
        
    </div>
    <div class="navitem " id="mustard">
        <a   onclick="document.body.theme('mustard')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Mustard</span>
        </a>
        
    </div>
    <div class="navitem " id="peachy">
        <a   onclick="document.body.theme('peachy')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Peachy</span>
        </a>
        
    </div>
    <div class="navitem " id="red-alert">
        <a   onclick="document.body.theme('red-alert')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Red Alert</span>
        </a>
        
    </div>
    <div class="navitem " id="ultra-violet">
        <a   onclick="document.body.theme('ultra-violet')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ultra Violet</span>
        </a>
        
    </div>
    <div class="navitem " id="vintage">
        <a   onclick="document.body.theme('vintage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Vintage</span>
        </a>
        
    </div>
    </div>
    </div>
    </div>
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        
        <div class="layout">
            <div class="sidepane narrow-scrollbars">
                
        <div class="tocmenu">
            <h3>Table of Contents</h3>
            
    <ul>
        
    <li>
        <a href="../README.html"><span>🏠</span><span data-toggle="tooltip" data-title="Home page">
            Home
        </span></a>
    </li>
    <li>
        <a href="../tutorial.html"><span>🎓</span><span data-toggle="tooltip" data-title="How to create your own keymaps">
            Tutorial
        </span></a>
    </li>
    <li>
        <a href="../presets/vim.html"><span>🦈</span><span data-toggle="tooltip" data-title="Built-in Vim presets">
            Vim Presets
        </span></a>
    </li>
    <li>
        
    <div class="accordion">
        Implementation
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="extension.html"><span>🔌</span><span data-toggle="tooltip" data-title="Main extension module">
            Extension
        </span></a>
    </li>
    <li>
        <a href="actions.html"><span>⌨️</span><span data-toggle="tooltip" data-title="Keymap management">
            Actions
        </span></a>
    </li>
    <li>
        <a href="commands.html" class="highlight"><span>📢</span><span data-toggle="tooltip" data-title="Registered commands">
            Commands
        </span></a>
    </li>
    </ul>
    </li>
    <li>
        <a href="../CHANGELOG.html"><span>📅</span><span data-toggle="tooltip" data-title="Version history">
            Change Log
        </span></a>
    </li>
    <li>
        <a href="../LICENSE.html"><span>📜</span><span data-toggle="tooltip" data-title="MIT license">
            License
        </span></a>
    </li>
    </ul>
        </div>
                <div class="toc-button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-right" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M7 7l5 5l-5 5" />
            <path d="M13 7l5 5l-5 5" />
        </svg></div>
            </div>
            
        <div class="contentarea closepopups">
            <h1 id="commands-and-state">Commands and State</h1>
<p>This module implements the new commands provided by ModalEdit. It also stores
the extension state; which mode we are in, search parameters, bookmarks,
quick snippets, etc.</p>
<details>
<summary>commands.ts imports</summary>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="263" data-toggle="tooltip" data-title="typeof vscode">vscode</span> <span class="keyword">from</span> <span class="string">&#039;vscode&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="297" data-toggle="tooltip" data-title="typeof actions">actions</span> <span class="keyword">from</span> <span class="string">&#039;./actions&#039;</span>
<span class="keyword">import</span> <span class="punctuation">{</span> <span id="337" data-toggle="tooltip" data-title="typeof TextDecoder">TextDecoder</span> <span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">&#039;util&#039;</span>
</code></pre>
</details>
<h2 id="command-arguments">Command Arguments</h2>
<p>Most commands provided by ModalEdit take arguments. Since command arguments
are stored in objects by-design, we define them as interfaces.</p>
<h3 id="search-arguments">Search Arguments</h3>
<p>Search arguments are documented in the
<a href="../README.html#code-modaledit-search-code">README</a>.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">interface</span> <span id="363" class="typename" data-toggle="tooltip" data-title="SearchArgs">SearchArgs</span> <span class="punctuation">{</span>
    <span id="720" data-toggle="tooltip" data-title="boolean | undefined">backwards</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="745" data-toggle="tooltip" data-title="boolean | undefined">caseSensitive</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="774" data-toggle="tooltip" data-title="boolean | undefined">wrapAround</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="800" data-toggle="tooltip" data-title="number | undefined">acceptAfter</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">number</span>
    <span id="826" data-toggle="tooltip" data-title="boolean | undefined">selectTillMatch</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="857" data-toggle="tooltip" data-title="string | undefined">typeAfterAccept</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="887" data-toggle="tooltip" data-title="string | undefined">typeBeforeNextMatch</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="921" data-toggle="tooltip" data-title="string | undefined">typeAfterNextMatch</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="954" data-toggle="tooltip" data-title="string | undefined">typeBeforePreviousMatch</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="992" data-toggle="tooltip" data-title="string | undefined">typeAfterPreviousMatch</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="bookmark-arguments">Bookmark Arguments</h3>
<p><a href="../README.html#bookmarks">Bookmark</a> ID is a user specified string label.
Actual positions are stored in an object that conforms to the <code>Bookmark</code>
interface in the <code>bookmarks</code> dictionary.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">interface</span> <span id="1032" class="typename" data-toggle="tooltip" data-title="BookmarkArgs">BookmarkArgs</span> <span class="punctuation">{</span>
    <span id="1299" data-toggle="tooltip" data-title="string | undefined">bookmark</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span>
    <span id="1323" data-toggle="tooltip" data-title="boolean | undefined">select</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
<span class="punctuation">}</span>

<span class="keyword">class</span> <span id="1348" class="typename" data-toggle="tooltip" data-title="Bookmark">Bookmark</span> <span class="keyword">implements</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.QuickPickItem">QuickPickItem</span> <span class="punctuation">{</span>
    <span class="keyword">public</span> <span id="1400" data-toggle="tooltip" data-title="string">description</span><span class="punctuation">:</span> <span class="keyword">string</span>

    <span class="keyword">constructor</span><span class="punctuation">(</span>
        <span class="keyword">public</span> <span id="1452" data-toggle="tooltip" data-title="string">label</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span>
        <span class="keyword">public</span> <span id="1483" data-toggle="tooltip" data-title="vscode.TextDocument">document</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextDocument">TextDocument</span><span class="punctuation">,</span>
        <span class="keyword">public</span> <span id="1530" data-toggle="tooltip" data-title="vscode.Position">position</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Position">Position</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="1588" data-toggle="tooltip" data-title="number">ln</span> <span class="punctuation">=</span> <a href="commands.html#1530"><span data-toggle="tooltip" data-title="vscode.Position">position</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">line</span>
        <span class="keyword">let</span> <span id="1620" data-toggle="tooltip" data-title="number">col</span> <span class="punctuation">=</span> <a href="commands.html#1530"><span data-toggle="tooltip" data-title="vscode.Position">position</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">character</span>
        <span class="keyword">let</span> <span id="1658" data-toggle="tooltip" data-title="string">text</span> <span class="punctuation">=</span> <a href="commands.html#1483"><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (line: number): vscode.TextLine; (position: vscode.Position): vscode.TextLine; }">lineAt</span><span class="punctuation">(</span><a href="commands.html#1588"><span data-toggle="tooltip" data-title="number">ln</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">text</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="commands.html#1400"><span data-toggle="tooltip" data-title="string">description</span></a> <span class="punctuation">=</span> <span class="string">`Ln ${</span><a href="commands.html#1588"><span data-toggle="tooltip" data-title="number">ln</span></a><span class="string">}, Col ${</span><a href="commands.html#1620"><span data-toggle="tooltip" data-title="number">col</span></a><span class="string">}: ${</span><a href="commands.html#1658"><span data-toggle="tooltip" data-title="string">text</span></a><span class="string">}`</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="quick-snippet-arguments">Quick Snippet Arguments</h3>
<p><a href="../README.html#quick-snippets">Quick snippets</a> are also stored in an array.
So their IDs are indexes as well.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">interface</span> <span id="1760" class="typename" data-toggle="tooltip" data-title="QuickSnippetArgs">QuickSnippetArgs</span> <span class="punctuation">{</span>
    <span id="1955" data-toggle="tooltip" data-title="number">snippet</span><span class="punctuation">:</span> <span class="keyword">number</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="type-normal-keys-arguments">Type Normal Keys Arguments</h3>
<p>The <a href="../README.html#invoking-key-bindings"><code>typeNormalKeys</code> command</a> gets the
entered keys as a string.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">interface</span> <span id="1979" class="typename" data-toggle="tooltip" data-title="TypeNormalKeysArgs">TypeNormalKeysArgs</span> <span class="punctuation">{</span>
    <span id="2172" data-toggle="tooltip" data-title="string">keys</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="select-between-arguments">Select Between Arguments</h3>
<p>The <code>selectBetween</code> command takes as arguments the strings/regular
expressions which delimit the text to be selected. Both of them are optional,
but in order for the command to do anything one of them needs to be defined.
If the <code>from</code> argument is missing, the selection goes from the cursor
position forwards to the <code>to</code> string. If the <code>to</code> is missing the selection
goes backwards till the <code>from</code> string.</p>
<p>If the <code>regex</code> flag is on, <code>from</code> and <code>to</code> strings are treated as regular
expressions in the search.</p>
<p>The <code>inclusive</code> flag tells if the delimiter strings are included in the
selection or not. By default the delimiter strings are not part of the
selection. Last, the <code>caseSensitive</code> flag makes the search case sensitive.
When this flag is missing or false the search is case insensitive.</p>
<p>By default the search scope is the current line. If you want search inside
the whole document, set the <code>docScope</code> flag.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">interface</span> <span id="2193" class="typename" data-toggle="tooltip" data-title="SelectBetweenArgs">SelectBetweenArgs</span> <span class="punctuation">{</span>
    <span id="3251" data-toggle="tooltip" data-title="string">from</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="3269" data-toggle="tooltip" data-title="string">to</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="3285" data-toggle="tooltip" data-title="boolean">regex</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="3305" data-toggle="tooltip" data-title="boolean">inclusive</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="3329" data-toggle="tooltip" data-title="boolean">caseSensitive</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
    <span id="3357" data-toggle="tooltip" data-title="boolean">docScope</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="state-variables">State Variables</h2>
<p>The enabler for modal editing is the <code>type</code> event that VS Code provides. It
reroutes the user's key presses to our extension. We store the handler to
this event in the <code>typeSubscription</code> variable.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="3634" data-toggle="tooltip" data-title="vscode.Disposable | undefined">typeSubscription</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Disposable">Disposable</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
</code></pre>
<p>We add two items in the status bar that show the current mode. The main
status bar shows the current state we are in. The secondary status bar shows
additional info such as keys that have been pressed so far and any help
strings defined in key bindings.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="3967" data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.StatusBarItem">StatusBarItem</span>
<span class="keyword">let</span> <span id="4008" data-toggle="tooltip" data-title="vscode.StatusBarItem">secondaryStatusBar</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.StatusBarItem">StatusBarItem</span>
</code></pre>
<p>This is the main mode flag that tells if we are in normal mode or insert
mode.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4151" data-toggle="tooltip" data-title="boolean">normalMode</span> <span class="punctuation">=</span> <span class="keyword">true</span>
</code></pre>
<p>The <code>selecting</code> flag indicates if we have initiated selection mode. Note that
it is not the only indicator that tells whether a selection is active.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4341" data-toggle="tooltip" data-title="boolean">selecting</span> <span class="punctuation">=</span> <span class="keyword">false</span>
</code></pre>
<p>The <code>searching</code> flag tells if <code>modaledit.search</code> command is in operation.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4452" data-toggle="tooltip" data-title="boolean">searching</span> <span class="punctuation">=</span> <span class="keyword">false</span>
</code></pre>
<p>Search state variables.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4513" data-toggle="tooltip" data-title="string">searchString</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="keyword">let</span> <span id="4539" data-toggle="tooltip" data-title="vscode.Selection[]">searchStartSelections</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Selection">Selection</span><span class="punctuation">[</span><span class="punctuation">]</span>
<span class="keyword">let</span> <span id="4586" data-toggle="tooltip" data-title="string | null">searchInfo</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">null</span> <span class="punctuation">=</span> <span class="keyword">null</span>
</code></pre>
<p>Current search parameters.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4665" data-toggle="tooltip" data-title="boolean">searchBackwards</span> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="keyword">let</span> <span id="4694" data-toggle="tooltip" data-title="boolean">searchCaseSensitive</span> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="keyword">let</span> <span id="4727" data-toggle="tooltip" data-title="boolean">searchWrapAround</span> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="keyword">let</span> <span id="4757" data-toggle="tooltip" data-title="number">searchAcceptAfter</span> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" data-title="NumberConstructor">Number</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">POSITIVE_INFINITY</span>
<span class="keyword">let</span> <span id="4807" data-toggle="tooltip" data-title="boolean">searchSelectTillMatch</span> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="keyword">let</span> <span id="4842" data-toggle="tooltip" data-title="string | undefined">searchTypeAfterAccept</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="4889" data-toggle="tooltip" data-title="string | undefined">searchTypeBeforeNextMatch</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="4940" data-toggle="tooltip" data-title="string | undefined">searchTypeAfterNextMatch</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="4990" data-toggle="tooltip" data-title="string | undefined">searchTypeBeforePreviousMatch</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="5045" data-toggle="tooltip" data-title="string | undefined">searchTypeAfterPreviousMatch</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="5099" data-toggle="tooltip" data-title="boolean">searchReturnToNormal</span> <span class="punctuation">=</span> <span class="keyword">true</span>
</code></pre>
<p>Bookmarks are stored here.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="5173" data-toggle="tooltip" data-title="{ [label: string]: Bookmark; }">bookmarks</span><span class="punctuation">:</span> <span class="punctuation">{</span> <span class="punctuation">[</span><span id="5188" data-toggle="tooltip" data-title="string">label</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">]</span><span class="punctuation">:</span> <a href="commands.html#1348"><span class="typename" data-toggle="tooltip" data-title="Bookmark">Bookmark</span></a> <span class="punctuation">}</span> <span class="punctuation">=</span> <span class="punctuation">{</span><span class="punctuation">}</span>
</code></pre>
<p>Quick snippets are simply stored in an array of strings.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="5295" data-toggle="tooltip" data-title="string[]">quickSnippets</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
</code></pre>
<p>&quot;Repeat last change&quot; command needs to know when text in editor has changed.
It also needs to save the current and last command key sequence, as well as
the last sequence that caused text to change.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="5549" data-toggle="tooltip" data-title="boolean">textChanged</span> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="keyword">let</span> <span id="5574" data-toggle="tooltip" data-title="string[]">currentKeySequence</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
<span class="keyword">let</span> <span id="5613" data-toggle="tooltip" data-title="string[]">lastKeySequence</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
<span class="keyword">let</span> <span id="5649" data-toggle="tooltip" data-title="string[]">lastChange</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
</code></pre>
<h2 id="command-names">Command Names</h2>
<p>Since command names are easy to misspell, we define them as constants.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="5792" data-toggle="tooltip" data-title="&quot;modaledit.toggle&quot;">toggleId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.toggle&quot;</span>
<span class="keyword">const</span> <span id="5829" data-toggle="tooltip" data-title="&quot;modaledit.enterNormal&quot;">enterNormalId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.enterNormal&quot;</span>
<span class="keyword">const</span> <span id="5876" data-toggle="tooltip" data-title="&quot;modaledit.enterInsert&quot;">enterInsertId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.enterInsert&quot;</span>
<span class="keyword">const</span> <span id="5923" data-toggle="tooltip" data-title="&quot;modaledit.toggleSelection&quot;">toggleSelectionId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.toggleSelection&quot;</span>
<span class="keyword">const</span> <span id="5978" data-toggle="tooltip" data-title="&quot;modaledit.enableSelection&quot;">enableSelectionId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.enableSelection&quot;</span>
<span class="keyword">const</span> <span id="6033" data-toggle="tooltip" data-title="&quot;modaledit.cancelSelection&quot;">cancelSelectionId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.cancelSelection&quot;</span>
<span class="keyword">const</span> <span id="6088" data-toggle="tooltip" data-title="&quot;modaledit.cancelMultipleSelections&quot;">cancelMultipleSelectionsId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.cancelMultipleSelections&quot;</span>
<span class="keyword">const</span> <span id="6161" data-toggle="tooltip" data-title="&quot;modaledit.search&quot;">searchId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.search&quot;</span>
<span class="keyword">const</span> <span id="6198" data-toggle="tooltip" data-title="&quot;modaledit.cancelSearch&quot;">cancelSearchId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.cancelSearch&quot;</span>
<span class="keyword">const</span> <span id="6247" data-toggle="tooltip" data-title="&quot;modaledit.deleteCharFromSearch&quot;">deleteCharFromSearchId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.deleteCharFromSearch&quot;</span>
<span class="keyword">const</span> <span id="6312" data-toggle="tooltip" data-title="&quot;modaledit.nextMatch&quot;">nextMatchId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.nextMatch&quot;</span>
<span class="keyword">const</span> <span id="6355" data-toggle="tooltip" data-title="&quot;modaledit.previousMatch&quot;">previousMatchId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.previousMatch&quot;</span>
<span class="keyword">const</span> <span id="6406" data-toggle="tooltip" data-title="&quot;modaledit.defineBookmark&quot;">defineBookmarkId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.defineBookmark&quot;</span>
<span class="keyword">const</span> <span id="6459" data-toggle="tooltip" data-title="&quot;modaledit.goToBookmark&quot;">goToBookmarkId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.goToBookmark&quot;</span>
<span class="keyword">const</span> <span id="6508" data-toggle="tooltip" data-title="&quot;modaledit.showBookmarks&quot;">showBookmarksId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.showBookmarks&quot;</span>
<span class="keyword">const</span> <span id="6559" data-toggle="tooltip" data-title="&quot;modaledit.fillSnippetArgs&quot;">fillSnippetArgsId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.fillSnippetArgs&quot;</span>
<span class="keyword">const</span> <span id="6614" data-toggle="tooltip" data-title="&quot;modaledit.defineQuickSnippet&quot;">defineQuickSnippetId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.defineQuickSnippet&quot;</span>
<span class="keyword">const</span> <span id="6675" data-toggle="tooltip" data-title="&quot;modaledit.insertQuickSnippet&quot;">insertQuickSnippetId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.insertQuickSnippet&quot;</span>
<span class="keyword">const</span> <span id="6736" data-toggle="tooltip" data-title="&quot;modaledit.typeNormalKeys&quot;">typeNormalKeysId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.typeNormalKeys&quot;</span>
<span class="keyword">const</span> <span id="6789" data-toggle="tooltip" data-title="&quot;modaledit.selectBetween&quot;">selectBetweenId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.selectBetween&quot;</span>
<span class="keyword">const</span> <span id="6840" data-toggle="tooltip" data-title="&quot;modaledit.repeatLastChange&quot;">repeatLastChangeId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.repeatLastChange&quot;</span>
<span class="keyword">const</span> <span id="6897" data-toggle="tooltip" data-title="&quot;modaledit.importPresets&quot;">importPresetsId</span> <span class="punctuation">=</span> <span class="string">&quot;modaledit.importPresets&quot;</span>
</code></pre>
<h2 id="registering-commands">Registering Commands</h2>
<p>The commands are registered when the extension is activated (main entry point
calls this function). We also create the status bar item.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="6941" class="member" data-toggle="tooltip" data-title="(context: vscode.ExtensionContext) =&gt; void">register</span><span class="punctuation">(</span><span id="7154" data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.ExtensionContext">ExtensionContext</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#7154"><span data-toggle="tooltip" data-title="vscode.ExtensionContext">context</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="{ dispose(): any; }[]">subscriptions</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: { dispose(): any; }[]) =&gt; number">push</span><span class="punctuation">(</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#5792"><span data-toggle="tooltip" data-title="&quot;modaledit.toggle&quot;">toggleId</span></a><span class="punctuation">,</span> <a href="commands.html#10811"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">toggle</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#5829"><span data-toggle="tooltip" data-title="&quot;modaledit.enterNormal&quot;">enterNormalId</span></a><span class="punctuation">,</span> <a href="commands.html#11019"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterNormal</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#5876"><span data-toggle="tooltip" data-title="&quot;modaledit.enterInsert&quot;">enterInsertId</span></a><span class="punctuation">,</span> <a href="commands.html#11519"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterInsert</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#5923"><span data-toggle="tooltip" data-title="&quot;modaledit.toggleSelection&quot;">toggleSelectionId</span></a><span class="punctuation">,</span> <a href="commands.html#15832"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">toggleSelection</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#5978"><span data-toggle="tooltip" data-title="&quot;modaledit.enableSelection&quot;">enableSelectionId</span></a><span class="punctuation">,</span> <a href="commands.html#16281"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enableSelection</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6033"><span data-toggle="tooltip" data-title="&quot;modaledit.cancelSelection&quot;">cancelSelectionId</span></a><span class="punctuation">,</span> <a href="commands.html#14664"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSelection</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6088"><span data-toggle="tooltip" data-title="&quot;modaledit.cancelMultipleSelections&quot;">cancelMultipleSelectionsId</span></a><span class="punctuation">,</span> 
            <a href="commands.html#15228"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">cancelMultipleSelections</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6161"><span data-toggle="tooltip" data-title="&quot;modaledit.search&quot;">searchId</span></a><span class="punctuation">,</span> <a href="commands.html#18080"><span class="member" data-toggle="tooltip" data-title="(args: SearchArgs | string) =&gt; Promise&lt;void&gt;">search</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6198"><span data-toggle="tooltip" data-title="&quot;modaledit.cancelSearch&quot;">cancelSearchId</span></a><span class="punctuation">,</span> <a href="commands.html#25021"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSearch</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6247"><span data-toggle="tooltip" data-title="&quot;modaledit.deleteCharFromSearch&quot;">deleteCharFromSearchId</span></a><span class="punctuation">,</span>
            <a href="commands.html#25463"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">deleteCharFromSearch</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6312"><span data-toggle="tooltip" data-title="&quot;modaledit.nextMatch&quot;">nextMatchId</span></a><span class="punctuation">,</span> <a href="commands.html#26647"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">nextMatch</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6355"><span data-toggle="tooltip" data-title="&quot;modaledit.previousMatch&quot;">previousMatchId</span></a><span class="punctuation">,</span> <a href="commands.html#27526"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">previousMatch</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6406"><span data-toggle="tooltip" data-title="&quot;modaledit.defineBookmark&quot;">defineBookmarkId</span></a><span class="punctuation">,</span> <a href="commands.html#28200"><span class="member" data-toggle="tooltip" data-title="(args?: BookmarkArgs) =&gt; void">defineBookmark</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6459"><span data-toggle="tooltip" data-title="&quot;modaledit.goToBookmark&quot;">goToBookmarkId</span></a><span class="punctuation">,</span> <a href="commands.html#28713"><span class="member" data-toggle="tooltip" data-title="(args?: BookmarkArgs) =&gt; Promise&lt;void&gt;">goToBookmark</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6508"><span data-toggle="tooltip" data-title="&quot;modaledit.showBookmarks&quot;">showBookmarksId</span></a><span class="punctuation">,</span> <a href="commands.html#29382"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">showBookmarks</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6559"><span data-toggle="tooltip" data-title="&quot;modaledit.fillSnippetArgs&quot;">fillSnippetArgsId</span></a><span class="punctuation">,</span> <a href="commands.html#30198"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">fillSnippetArgs</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6614"><span data-toggle="tooltip" data-title="&quot;modaledit.defineQuickSnippet&quot;">defineQuickSnippetId</span></a><span class="punctuation">,</span> <a href="commands.html#30740"><span class="member" data-toggle="tooltip" data-title="(args?: QuickSnippetArgs) =&gt; void">defineQuickSnippet</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6675"><span data-toggle="tooltip" data-title="&quot;modaledit.insertQuickSnippet&quot;">insertQuickSnippetId</span></a><span class="punctuation">,</span> <a href="commands.html#31037"><span class="member" data-toggle="tooltip" data-title="(args?: QuickSnippetArgs) =&gt; Promise&lt;void&gt;">insertQuickSnippet</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6736"><span data-toggle="tooltip" data-title="&quot;modaledit.typeNormalKeys&quot;">typeNormalKeysId</span></a><span class="punctuation">,</span> <a href="commands.html#31484"><span class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6789"><span data-toggle="tooltip" data-title="&quot;modaledit.selectBetween&quot;">selectBetweenId</span></a><span class="punctuation">,</span> <a href="commands.html#32005"><span class="member" data-toggle="tooltip" data-title="(args: SelectBetweenArgs) =&gt; void">selectBetween</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6840"><span data-toggle="tooltip" data-title="&quot;modaledit.repeatLastChange&quot;">repeatLastChangeId</span></a><span class="punctuation">,</span> <a href="commands.html#37424"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">repeatLastChange</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><a href="commands.html#6897"><span data-toggle="tooltip" data-title="&quot;modaledit.importPresets&quot;">importPresetsId</span></a><span class="punctuation">,</span> <a href="commands.html#38015"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">importPresets</span></a><span class="punctuation">)</span>
    <span class="punctuation">)</span>
    <a href="commands.html#3967"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span></a> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (id: string, alignment?: vscode.StatusBarAlignment, priority?: number): vscode.StatusBarItem; (alignment?: vscode.StatusBarAlignment, priority?: number): vscode.StatusBarItem; }">createStatusBarItem</span><span class="punctuation">(</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.StatusBarAlignment">StatusBarAlignment</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.StatusBarAlignment.Left">Left</span><span class="punctuation">)</span>
    <a href="commands.html#3967"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string | vscode.Command | undefined">command</span> <span class="punctuation">=</span> <a href="commands.html#5792"><span data-toggle="tooltip" data-title="&quot;modaledit.toggle&quot;">toggleId</span></a>
    <a href="commands.html#4008"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">secondaryStatusBar</span></a> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (id: string, alignment?: vscode.StatusBarAlignment, priority?: number): vscode.StatusBarItem; (alignment?: vscode.StatusBarAlignment, priority?: number): vscode.StatusBarItem; }">createStatusBarItem</span><span class="punctuation">(</span>
        <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.StatusBarAlignment">StatusBarAlignment</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.StatusBarAlignment.Left">Left</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="keyboard-event-handler">Keyboard Event Handler</h2>
<p>When the user types in normal mode, <code>onType</code> handler gets each typed
character one at a time. It calls the <code>runActionForKey</code> subroutine to invoke
the action bound to the typed key. In addition, it updates the state
variables needed by the <code>repeatLastChange</code> command and the status bar.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="9157" class="member" data-toggle="tooltip" data-title="(event: { text: string; }) =&gt; Promise&lt;void&gt;">onType</span><span class="punctuation">(</span><span id="9527" data-toggle="tooltip" data-title="{ text: string; }">event</span><span class="punctuation">:</span> <span class="punctuation">{</span> <span id="9535" data-toggle="tooltip" data-title="string">text</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">}</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#5549"><span data-toggle="tooltip" data-title="boolean">textChanged</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="commands.html#5649"><span data-toggle="tooltip" data-title="string[]">lastChange</span></a> <span class="punctuation">=</span> <a href="commands.html#5613"><span data-toggle="tooltip" data-title="string[]">lastKeySequence</span></a>
        <a href="commands.html#5549"><span data-toggle="tooltip" data-title="boolean">textChanged</span></a> <span class="punctuation">=</span> <span class="keyword">false</span>
    <span class="punctuation">}</span>
    <a href="commands.html#5574"><span data-toggle="tooltip" data-title="string[]">currentKeySequence</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><a href="commands.html#9527"><span data-toggle="tooltip" data-title="{ text: string; }">event</span></a><span class="punctuation">.</span><a href="commands.html#9535"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">await</span> <a href="commands.html#10200"><span class="member" data-toggle="tooltip" data-title="(key: string) =&gt; Promise&lt;boolean&gt;">runActionForKey</span></a><span class="punctuation">(</span><a href="commands.html#9527"><span data-toggle="tooltip" data-title="{ text: string; }">event</span></a><span class="punctuation">.</span><a href="commands.html#9535"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="commands.html#5613"><span data-toggle="tooltip" data-title="string[]">lastKeySequence</span></a> <span class="punctuation">=</span> <a href="commands.html#5574"><span data-toggle="tooltip" data-title="string[]">currentKeySequence</span></a>
        <a href="commands.html#5574"><span data-toggle="tooltip" data-title="string[]">currentKeySequence</span></a> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
    <span class="punctuation">}</span>
    <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">,</span> <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#21447"><span class="member" data-toggle="tooltip" data-title="() =&gt; string | undefined">getHelp</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>Whenever text changes in an active editor, we set a flag. This flag is
examined in the <code>onType</code> handler above, and the <code>lastChange</code> variable is set
to indicate that the last command that changed editor text.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="9908" class="member" data-toggle="tooltip" data-title="() =&gt; void">onTextChanged</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#5549"><span data-toggle="tooltip" data-title="boolean">textChanged</span></a> <span class="punctuation">=</span> <span class="keyword">true</span>
<span class="punctuation">}</span>
</code></pre>
<p>This helper function just calls the <code>handleKey</code> function in the <code>actions</code>
module. It checks if we have an active selection or search mode on, and
passes that information to the function. <code>handleKey</code> returns <code>true</code> if the
key actually invoked a command, or <code>false</code> if it was a part of incomplete
key sequence that did not (yet) cause any commands to run. This information
is needed to decide whether the <code>lastKeySequence</code> variable is updated.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="10200" class="member" data-toggle="tooltip" data-title="(key: string) =&gt; Promise&lt;boolean&gt;">runActionForKey</span><span class="punctuation">(</span><span id="10709" data-toggle="tooltip" data-title="string">key</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">boolean</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="keyword">await</span> <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#19790"><span class="member" data-toggle="tooltip" data-title="(key: string, selecting: boolean, capture: boolean) =&gt; Promise&lt;boolean&gt;">handleKey</span></a><span class="punctuation">(</span><a href="commands.html#10709"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">,</span> <a href="commands.html#16469"><span class="member" data-toggle="tooltip" data-title="() =&gt; boolean">isSelecting</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> <a href="commands.html#4452"><span data-toggle="tooltip" data-title="boolean">searching</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="mode-switching-commands">Mode Switching  Commands</h2>
<p><code>toggle</code> switches between normal and insert mode.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="10811" class="member" data-toggle="tooltip" data-title="() =&gt; void">toggle</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a><span class="punctuation">)</span>
        <a href="commands.html#11519"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterInsert</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="keyword">else</span>
        <a href="commands.html#11019"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterNormal</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>When entering normal mode, we:</p>
<ol>
<li>abort any running actions,</li>
<li>cancel the search, if it is on,</li>
<li>subscribe to the <code>type</code> event,</li>
<li>handle the rest of the mode setup with <code>setNormalMode</code> function, and</li>
<li>clear the selection.</li>
</ol>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="11019" class="member" data-toggle="tooltip" data-title="() =&gt; void">enterNormal</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#17064"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">abortActions</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <a href="commands.html#25021"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSearch</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#3634"><span data-toggle="tooltip" data-title="vscode.Disposable | undefined">typeSubscription</span></a><span class="punctuation">)</span>
        <a href="commands.html#3634"><span data-toggle="tooltip" data-title="vscode.Disposable | undefined">typeSubscription</span></a> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(command: string, callback: (...args: any[]) =&gt; any, thisArg?: any) =&gt; vscode.Disposable">registerCommand</span><span class="punctuation">(</span><span class="string">&quot;type&quot;</span><span class="punctuation">,</span> <a href="commands.html#9157"><span class="member" data-toggle="tooltip" data-title="(event: { text: string; }) =&gt; Promise&lt;void&gt;">onType</span></a><span class="punctuation">)</span>
    <a href="commands.html#12158"><span class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setNormalMode</span></a><span class="punctuation">(</span><span class="keyword">true</span><span class="punctuation">)</span>
    <a href="commands.html#14664"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSelection</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>Conversely, when entering insert mode, we:</p>
<ol>
<li>cancel the search, if it is on (yes, you can use it in insert mode, too),</li>
<li>unsubscribe to the <code>type</code> event,</li>
<li>handle the rest of the mode setup with <code>setNormalMode</code> function.</li>
</ol>
<p>Note that we specifically don't clear the selection. This allows the user
to easily surround selected text with hyphens <code>'</code>, parenthesis <code>(</code> and <code>)</code>,
brackets <code>[</code> and <code>]</code>, etc.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="11519" class="member" data-toggle="tooltip" data-title="() =&gt; void">enterInsert</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#25021"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSearch</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#3634"><span data-toggle="tooltip" data-title="vscode.Disposable | undefined">typeSubscription</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="commands.html#3634"><span data-toggle="tooltip" data-title="vscode.Disposable">typeSubscription</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; any">dispose</span><span class="punctuation">(</span><span class="punctuation">)</span>
        <a href="commands.html#3634"><span data-toggle="tooltip" data-title="vscode.Disposable | undefined">typeSubscription</span></a> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <span class="punctuation">}</span>
    <a href="commands.html#12158"><span class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setNormalMode</span></a><span class="punctuation">(</span><span class="keyword">false</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>The rest of the state handling is delegated to subroutines that do specific
things. <code>setNormalMode</code> sets or resets the VS Code <code>modaledit.normal</code> context.
This can be used in &quot;standard&quot; key bindings. Then it sets the <code>normalMode</code>
variable and calls the next subroutine which updates cursor and status bar.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="12158" class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setNormalMode</span><span class="punctuation">(</span><span id="12521" data-toggle="tooltip" data-title="boolean">value</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">const</span> <span id="12564" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#12564"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><span class="string">&quot;setContext&quot;</span><span class="punctuation">,</span> <span class="string">&quot;modaledit.normal&quot;</span><span class="punctuation">,</span>
            <a href="commands.html#12521"><span data-toggle="tooltip" data-title="boolean">value</span></a><span class="punctuation">)</span>
        <a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a> <span class="punctuation">=</span> <a href="commands.html#12521"><span data-toggle="tooltip" data-title="boolean">value</span></a>
        <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#12564"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>This function updates the cursor shape and status bar according to editor
state. It indicates when selection is active or search mode is on. If
so, it shows the search parameters. If no editor is active, we hide the
status bar items.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="12803" class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span><span class="punctuation">(</span><span id="13106" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditor">TextEditor</span> <span class="punctuation">|</span> <span class="keyword">undefined</span><span class="punctuation">,</span>
    <span id="13144" data-toggle="tooltip" data-title="string | undefined">help</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#13106"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="comment">// Get the style parameters</span>
        <span class="keyword">let</span> <span class="punctuation">[</span><span id="13237" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">style</span><span class="punctuation">,</span> <span id="13243" data-toggle="tooltip" data-title="string">text</span><span class="punctuation">,</span> <span id="13249" data-toggle="tooltip" data-title="string | undefined">color</span><span class="punctuation">]</span> <span class="punctuation">=</span>
            <a href="commands.html#4452"><span data-toggle="tooltip" data-title="boolean">searching</span></a> <span class="punctuation">?</span> <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#5553"><span class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getSearchStyles</span></a><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">:</span>
                <a href="commands.html#16469"><span class="member" data-toggle="tooltip" data-title="() =&gt; boolean">isSelecting</span></a><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a> <span class="punctuation">?</span> <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#5733"><span class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getSelectStyles</span></a><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">:</span>
                    <a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a> <span class="punctuation">?</span> <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#5373"><span class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getNormalStyles</span></a><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">:</span>
                        <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#5079"><span class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getInsertStyles</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
</code></pre>
<p>Update the cursor style.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <a href="commands.html#13106"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorOptions">options</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle | undefined">cursorStyle</span> <span class="punctuation">=</span> <a href="commands.html#13237"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">style</span></a>
</code></pre>
<p>Update the main status bar.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <a href="commands.html#3967"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">text</span> <span class="punctuation">=</span> <a href="commands.html#4452"><span data-toggle="tooltip" data-title="boolean">searching</span></a> <span class="punctuation">?</span>
            <span class="string">`${</span><a href="commands.html#13243"><span data-toggle="tooltip" data-title="string">text</span></a><span class="string">} [${</span><a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">?</span> <span class="string">&quot;B&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;F&quot;</span>
            <span class="string">}${</span><a href="commands.html#4694"><span data-toggle="tooltip" data-title="boolean">searchCaseSensitive</span></a> <span class="punctuation">?</span> <span class="string">&quot;S&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="string">}]: ${</span><a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="string">}`</span> <span class="punctuation">:</span>
            <a href="commands.html#13243"><span data-toggle="tooltip" data-title="string">text</span></a>
        <a href="commands.html#3967"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string | vscode.ThemeColor | undefined">color</span> <span class="punctuation">=</span> <a href="commands.html#13249"><span data-toggle="tooltip" data-title="string | undefined">color</span></a>
        <a href="commands.html#3967"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">show</span><span class="punctuation">(</span><span class="punctuation">)</span>
</code></pre>
<p>Update secondary status bar. If there is any keys pressed in the
current sequence, we show them. Also possible help string is shown.
The info given by search command is shown only as long there are
no other messages to show.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <span class="keyword">let</span> <span id="14235" data-toggle="tooltip" data-title="string">sec</span> <span class="punctuation">=</span> <span class="string">&quot;    &quot;</span> <span class="punctuation">+</span> <a href="commands.html#5574"><span data-toggle="tooltip" data-title="string[]">currentKeySequence</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#13144"><span data-toggle="tooltip" data-title="string | undefined">help</span></a><span class="punctuation">)</span>
            <a href="commands.html#14235"><span data-toggle="tooltip" data-title="string">sec</span></a> <span class="punctuation">=</span> <span class="string">`${</span><a href="commands.html#14235"><span data-toggle="tooltip" data-title="string">sec</span></a><span class="string">}    ${</span><a href="commands.html#13144"><span data-toggle="tooltip" data-title="string">help</span></a><span class="string">}`</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4586"><span data-toggle="tooltip" data-title="string | null">searchInfo</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#14235"><span data-toggle="tooltip" data-title="string">sec</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">trim</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">==</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span>
                <a href="commands.html#14235"><span data-toggle="tooltip" data-title="string">sec</span></a> <span class="punctuation">=</span> <a href="commands.html#4586"><span data-toggle="tooltip" data-title="string">searchInfo</span></a>
            <span class="keyword">else</span>
                <a href="commands.html#4586"><span data-toggle="tooltip" data-title="string | null">searchInfo</span></a> <span class="punctuation">=</span> <span class="keyword">null</span>
        <span class="punctuation">}</span>
        <a href="commands.html#4008"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">secondaryStatusBar</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">text</span> <span class="punctuation">=</span> <a href="commands.html#14235"><span data-toggle="tooltip" data-title="string">sec</span></a>
        <a href="commands.html#4008"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">secondaryStatusBar</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">show</span><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">else</span> <span class="punctuation">{</span>
        <a href="commands.html#3967"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">mainStatusBar</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">hide</span><span class="punctuation">(</span><span class="punctuation">)</span>
        <a href="commands.html#4008"><span data-toggle="tooltip" data-title="vscode.StatusBarItem">secondaryStatusBar</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">hide</span><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="selection-commands">Selection Commands</h2>
<p><code>modaledit.cancelSelection</code> command clears the selection using standard
<code>cancelSelection</code> command, but also sets the <code>selecting</code> flag to false, and
updates the status bar. It is advisable to use this command instead of the
standard version to keep the state in sync.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="14664" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSelection</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><span class="string">&quot;cancelSelection&quot;</span><span class="punctuation">)</span>
        <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">=</span> <span class="keyword">false</span>
        <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p><code>modaledit.cancelMultipleSelections</code>, like <code>modaledit.cancelSelection</code> sets
selecting to false and sets the anchor equal to active selection position.
Unlike <code>modaledit.cancelSelection</code> it preserves multiple cursors.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="15228" class="member" data-toggle="tooltip" data-title="() =&gt; void">cancelMultipleSelections</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="15543" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#15543"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span>
            <a href="commands.html#15543"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span> <span class="punctuation">=</span> <a href="commands.html#15543"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(callbackfn: (value: vscode.Selection, index: number, array: readonly vscode.Selection[]) =&gt; U, thisArg?: any) =&gt; U[]">map</span><span class="punctuation">(</span><span id="15660" data-toggle="tooltip" data-title="vscode.Selection">sel</span> <span class="punctuation">=&gt;</span>
                <span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Selection">Selection</span><span class="punctuation">(</span><a href="commands.html#15660"><span data-toggle="tooltip" data-title="vscode.Selection">sel</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">,</span> <a href="commands.html#15660"><span data-toggle="tooltip" data-title="vscode.Selection">sel</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">=</span> <span class="keyword">false</span>
        <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p><code>modaledit.toggleSelection</code> toggles the selection mode on and off. It sets
the selection mode flag and updates the status bar, but also clears the
selection.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="15832" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">toggleSelection</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="16072" data-toggle="tooltip" data-title="boolean">oldSelecting</span> <span class="punctuation">=</span> <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#16072"><span data-toggle="tooltip" data-title="boolean">oldSelecting</span></a><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><span class="string">&quot;cancelSelection&quot;</span><span class="punctuation">)</span>
    <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">=</span> <span class="punctuation">!</span><a href="commands.html#16072"><span data-toggle="tooltip" data-title="boolean">oldSelecting</span></a>
    <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p><code>modaledit.enableSelection</code> sets the selecting to true.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="16281" class="member" data-toggle="tooltip" data-title="() =&gt; void">enableSelection</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">=</span> <span class="keyword">true</span><span class="punctuation">;</span>
    <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>The following helper function actually determines, if a selection is active.
It checks not only the <code>selecting</code> flag but also if there is any text
selected in the active editor.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="16469" class="member" data-toggle="tooltip" data-title="() =&gt; boolean">isSelecting</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">boolean</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a> <span class="punctuation">&amp;&amp;</span> <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
        <span class="keyword">return</span> <span class="keyword">true</span>
    <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">!</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(predicate: (value: vscode.Selection, index: number, array: readonly vscode.Selection[]) =&gt; unknown, thisArg?: any) =&gt; boolean">some</span><span class="punctuation">(</span>
        <span id="16825" data-toggle="tooltip" data-title="vscode.Selection">selection</span> <span class="punctuation">=&gt;</span> <span class="punctuation">!</span><a href="commands.html#16825"><span data-toggle="tooltip" data-title="vscode.Selection">selection</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">anchor</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(other: vscode.Position) =&gt; boolean">isEqual</span><span class="punctuation">(</span><a href="commands.html#16825"><span data-toggle="tooltip" data-title="vscode.Selection">selection</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">)</span><span class="punctuation">)</span>
    <span class="keyword">return</span> <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a>
<span class="punctuation">}</span>
</code></pre>
<p>Function that sets the selecting flag off. This function is called from one
event. The flag is resetted when the active editor changes. The function that
updates the status bar sets the flag on again, if there are any active
selections.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="16917" class="member" data-toggle="tooltip" data-title="() =&gt; void">resetSelecting</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#4341"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="search-commands">Search Commands</h2>
<p>Incremental search is by far the most complicated part of this extension.
Searching overrides both normal and insert modes, and captures the keyboard
until it is done. The following subroutine sets the associated state
variable, the VS Code <code>modaledit.searching</code> context, and the status bar.
Since search mode also puts the editor implicitly in the normal mode, we
need to check what was the state when we initiated the search. If we were in
insert mode, we return also there.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="17242" class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setSearching</span><span class="punctuation">(</span><span id="17814" data-toggle="tooltip" data-title="boolean">value</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#4452"><span data-toggle="tooltip" data-title="boolean">searching</span></a> <span class="punctuation">=</span> <a href="commands.html#17814"><span data-toggle="tooltip" data-title="boolean">value</span></a>
    <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><span class="string">&quot;setContext&quot;</span><span class="punctuation">,</span>
        <span class="string">&quot;modaledit.searching&quot;</span><span class="punctuation">,</span> <a href="commands.html#17814"><span data-toggle="tooltip" data-title="boolean">value</span></a><span class="punctuation">)</span>
    <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><span class="punctuation">(</span><a href="commands.html#17814"><span data-toggle="tooltip" data-title="boolean">value</span></a> <span class="punctuation">||</span> <a href="commands.html#5099"><span data-toggle="tooltip" data-title="boolean">searchReturnToNormal</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <a href="commands.html#11519"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterInsert</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>This is the main command that not only initiates the search, but also handles
the key presses when search is active. That is why its argument is defined
as an union type. We also use the argument to detect whether we are starting
a new search or adding characters to the active search.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="18080" class="member" data-toggle="tooltip" data-title="(args: SearchArgs | string) =&gt; Promise&lt;void&gt;">search</span><span class="punctuation">(</span><span id="18416" data-toggle="tooltip" data-title="string | SearchArgs">args</span><span class="punctuation">:</span> <a href="commands.html#363"><span class="typename" data-toggle="tooltip" data-title="SearchArgs">SearchArgs</span></a> <span class="punctuation">|</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="18468" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#18468"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span>
        <span class="keyword">return</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#18416"><span data-toggle="tooltip" data-title="string | SearchArgs">args</span></a><span class="punctuation">)</span>
        <a href="commands.html#18416"><span data-toggle="tooltip" data-title="string | SearchArgs">args</span></a> <span class="punctuation">=</span> <span class="punctuation">{</span><span class="punctuation">}</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="string | SearchArgs">args</span></a> <span class="punctuation">==</span> <span class="string">&#039;object&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
</code></pre>
<p>If we get an object as argument, we start a new search. We switch
to normal mode, if necessary. Then we initialize the search string
to empty, and store the current selections in the
<code>searchStartSelections</code> array. We need an array as the command also
works with multiple cursors. Finally we store the search arguments
in the module level variables.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <a href="commands.html#5099"><span data-toggle="tooltip" data-title="boolean">searchReturnToNormal</span></a> <span class="punctuation">=</span> <a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a>
        <a href="commands.html#297"><span data-toggle="tooltip" data-title="typeof actions">actions</span></a><span class="punctuation">.</span><a href="actions.html#5998"><span class="member" data-toggle="tooltip" data-title="(command: string) =&gt; void">setLastCommand</span></a><span class="punctuation">(</span><a href="commands.html#6161"><span data-toggle="tooltip" data-title="&quot;modaledit.search&quot;">searchId</span></a><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#4151"><span data-toggle="tooltip" data-title="boolean">normalMode</span></a><span class="punctuation">)</span>
            <a href="commands.html#11019"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterNormal</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
        <a href="commands.html#17242"><span class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setSearching</span></a><span class="punctuation">(</span><span class="keyword">true</span><span class="punctuation">)</span>
        <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a> <span class="punctuation">=</span> <span class="string">&quot;&quot;</span>
        <a href="commands.html#4539"><span data-toggle="tooltip" data-title="vscode.Selection[]">searchStartSelections</span></a> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" data-title="ArrayConstructor">Array</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(arrayLike: ArrayLike&lt;T&gt;): T[]; &lt;T, U&gt;(arrayLike: ArrayLike&lt;T&gt;, mapfn: (v: T, k: number) =&gt; U, thisArg?: any): U[]; &lt;T&gt;(iterable: Iterable&lt;T&gt; | ArrayLike&lt;T&gt;): T[]; &lt;T, U&gt;(iterable: Iterable&lt;T&gt; | ArrayLike&lt;T&gt;, mapfn: (v: T, k: number) =&gt; U, thisArg?: any): U[]; }">from</span><span class="punctuation">(</span><a href="commands.html#18468"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span><span class="punctuation">)</span>
        <a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#720"><span data-toggle="tooltip" data-title="boolean | undefined">backwards</span></a> <span class="punctuation">||</span> <span class="keyword">false</span>
        <a href="commands.html#4694"><span data-toggle="tooltip" data-title="boolean">searchCaseSensitive</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#745"><span data-toggle="tooltip" data-title="boolean | undefined">caseSensitive</span></a> <span class="punctuation">||</span> <span class="keyword">false</span>
        <a href="commands.html#4727"><span data-toggle="tooltip" data-title="boolean">searchWrapAround</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#774"><span data-toggle="tooltip" data-title="boolean | undefined">wrapAround</span></a> <span class="punctuation">||</span> <span class="keyword">false</span>
        <a href="commands.html#4757"><span data-toggle="tooltip" data-title="number">searchAcceptAfter</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#800"><span data-toggle="tooltip" data-title="number | undefined">acceptAfter</span></a> <span class="punctuation">||</span> <span class="typename" data-toggle="tooltip" data-title="NumberConstructor">Number</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">POSITIVE_INFINITY</span>
        <a href="commands.html#4807"><span data-toggle="tooltip" data-title="boolean">searchSelectTillMatch</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#826"><span data-toggle="tooltip" data-title="boolean | undefined">selectTillMatch</span></a> <span class="punctuation">||</span> <span class="keyword">false</span>
        <a href="commands.html#4842"><span data-toggle="tooltip" data-title="string | undefined">searchTypeAfterAccept</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#857"><span data-toggle="tooltip" data-title="string | undefined">typeAfterAccept</span></a>
        <a href="commands.html#4889"><span data-toggle="tooltip" data-title="string | undefined">searchTypeBeforeNextMatch</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#887"><span data-toggle="tooltip" data-title="string | undefined">typeBeforeNextMatch</span></a>
        <a href="commands.html#4940"><span data-toggle="tooltip" data-title="string | undefined">searchTypeAfterNextMatch</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#921"><span data-toggle="tooltip" data-title="string | undefined">typeAfterNextMatch</span></a>
        <a href="commands.html#4990"><span data-toggle="tooltip" data-title="string | undefined">searchTypeBeforePreviousMatch</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#954"><span data-toggle="tooltip" data-title="string | undefined">typeBeforePreviousMatch</span></a>
        <a href="commands.html#5045"><span data-toggle="tooltip" data-title="string | undefined">searchTypeAfterPreviousMatch</span></a> <span class="punctuation">=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="SearchArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#992"><span data-toggle="tooltip" data-title="string | undefined">typeAfterPreviousMatch</span></a>
    <span class="punctuation">}</span>
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#18416"><span data-toggle="tooltip" data-title="string">args</span></a> <span class="punctuation">==</span> <span class="string">&quot;\n&quot;</span><span class="punctuation">)</span>
</code></pre>
<p>If we get an enter character we accept the search.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <span class="keyword">await</span> <a href="commands.html#24680"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">acceptSearch</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="keyword">else</span> <span class="punctuation">{</span>
</code></pre>
<p>Otherwise we just add the character to the search string and find
the next match. If <code>acceptAfter</code> argument is given, and we have a
sufficiently long search string, we accept the search automatically.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a> <span class="punctuation">+=</span> <a href="commands.html#18416"><span data-toggle="tooltip" data-title="string">args</span></a>
        <a href="commands.html#20545"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, selections: vscode.Selection[]) =&gt; void">highlightMatches</span></a><span class="punctuation">(</span><a href="commands.html#18468"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <a href="commands.html#4539"><span data-toggle="tooltip" data-title="vscode.Selection[]">searchStartSelections</span></a><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">&gt;=</span> <a href="commands.html#4757"><span data-toggle="tooltip" data-title="number">searchAcceptAfter</span></a><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="commands.html#24680"><span class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">acceptSearch</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>The actual search functionality is located in this helper function. It is
used by the actual search command plus the commands that jump to next and
previous match.</p>
<p>The search starts from positions specified by the <code>selections</code> argument. If
there are multilple selections (cursors) active, multiple searches are
performed. Each cursor location is considered separately, and the next match
from that position is selected. The function does <em>not</em> make sure that found
matches are unique. In case the matches overlap, the number of selections
will decrease.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="20545" class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, selections: vscode.Selection[]) =&gt; void">highlightMatches</span><span class="punctuation">(</span><span id="21177" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditor">TextEditor</span><span class="punctuation">,</span>
    <span id="21203" data-toggle="tooltip" data-title="vscode.Selection[]">selections</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Selection">Selection</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#4586"><span data-toggle="tooltip" data-title="string | null">searchInfo</span></a> <span class="punctuation">=</span> <span class="keyword">null</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a> <span class="punctuation">==</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span>
</code></pre>
<p>If search string is empty, we return to the start positions.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <a href="commands.html#21177"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span> <span class="punctuation">=</span> <a href="commands.html#4539"><span data-toggle="tooltip" data-title="vscode.Selection[]">searchStartSelections</span></a>
    <span class="keyword">else</span> <span class="punctuation">{</span>
</code></pre>
<p>We get the text of the active editor as string. If we have
case-insensitive search, we transform the text to lower case.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <span class="keyword">let</span> <span id="21640" data-toggle="tooltip" data-title="vscode.TextDocument">doc</span> <span class="punctuation">=</span> <a href="commands.html#21177"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span>
        <span class="keyword">let</span> <span id="21675" data-toggle="tooltip" data-title="string">docText</span> <span class="punctuation">=</span> <a href="commands.html#4694"><span data-toggle="tooltip" data-title="boolean">searchCaseSensitive</span></a> <span class="punctuation">?</span>
            <a href="commands.html#21640"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">:</span> <a href="commands.html#21640"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span>
</code></pre>
<p>Next we determine the search target. It is also transformed to
lower case, if search is case-insensitive.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <span class="keyword">let</span> <span id="21933" data-toggle="tooltip" data-title="string">target</span> <span class="punctuation">=</span> <a href="commands.html#4694"><span data-toggle="tooltip" data-title="boolean">searchCaseSensitive</span></a> <span class="punctuation">?</span>
            <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a> <span class="punctuation">:</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span>
        <a href="commands.html#21177"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span> <span class="punctuation">=</span> <a href="commands.html#21203"><span data-toggle="tooltip" data-title="vscode.Selection[]">selections</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(callbackfn: (value: vscode.Selection, index: number, array: vscode.Selection[]) =&gt; U, thisArg?: any) =&gt; U[]">map</span><span class="punctuation">(</span><span id="22064" data-toggle="tooltip" data-title="vscode.Selection">sel</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
</code></pre>
<p>This is the actual search that is performed for each cursor
position. The lambda function returns a new selection for each
active cursor.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>            <span class="keyword">let</span> <span id="22309" data-toggle="tooltip" data-title="number">startOffs</span> <span class="punctuation">=</span> <a href="commands.html#21640"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(position: vscode.Position) =&gt; number">offsetAt</span><span class="punctuation">(</span><a href="commands.html#22064"><span data-toggle="tooltip" data-title="vscode.Selection">sel</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">)</span>
</code></pre>
<p>Depending on the search direction we find either the
first or the last match from the start offset.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>            <span class="keyword">let</span> <span id="22529" data-toggle="tooltip" data-title="number">offs</span> <span class="punctuation">=</span> <a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">?</span>
                <a href="commands.html#21675"><span data-toggle="tooltip" data-title="string">docText</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchString: string, position?: number) =&gt; number">lastIndexOf</span><span class="punctuation">(</span><a href="commands.html#21933"><span data-toggle="tooltip" data-title="string">target</span></a><span class="punctuation">,</span> <a href="commands.html#22309"><span data-toggle="tooltip" data-title="number">startOffs</span></a> <span class="punctuation">-</span> <span class="number">1</span><span class="punctuation">)</span> <span class="punctuation">:</span>
                <a href="commands.html#21675"><span data-toggle="tooltip" data-title="string">docText</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchString: string, position?: number) =&gt; number">indexOf</span><span class="punctuation">(</span><a href="commands.html#21933"><span data-toggle="tooltip" data-title="string">target</span></a><span class="punctuation">,</span> <a href="commands.html#22309"><span data-toggle="tooltip" data-title="number">startOffs</span></a><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#22529"><span data-toggle="tooltip" data-title="number">offs</span></a> <span class="punctuation">&lt;</span> <span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4727"><span data-toggle="tooltip" data-title="boolean">searchWrapAround</span></a><span class="punctuation">)</span>
</code></pre>
<p>If search string was not found but <code>wrapAround</code> argument
was set, we try to find the search string from beginning
or end of the document. If that fails too, we return
the original selection and the cursor will not move.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>                    <a href="commands.html#22529"><span data-toggle="tooltip" data-title="number">offs</span></a> <span class="punctuation">=</span> <a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">?</span>
                        <a href="commands.html#21675"><span data-toggle="tooltip" data-title="string">docText</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchString: string, position?: number) =&gt; number">lastIndexOf</span><span class="punctuation">(</span><a href="commands.html#21933"><span data-toggle="tooltip" data-title="string">target</span></a><span class="punctuation">)</span> <span class="punctuation">:</span>
                        <a href="commands.html#21675"><span data-toggle="tooltip" data-title="string">docText</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchString: string, position?: number) =&gt; number">indexOf</span><span class="punctuation">(</span><a href="commands.html#21933"><span data-toggle="tooltip" data-title="string">target</span></a><span class="punctuation">)</span>
                <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#22529"><span data-toggle="tooltip" data-title="number">offs</span></a> <span class="punctuation">&lt;</span> <span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                    <a href="commands.html#4586"><span data-toggle="tooltip" data-title="string | null">searchInfo</span></a> <span class="punctuation">=</span> <span class="string">&quot;Pattern not found&quot;</span>
                    <span class="keyword">return</span> <a href="commands.html#22064"><span data-toggle="tooltip" data-title="vscode.Selection">sel</span></a>
                <span class="punctuation">}</span>
                <span class="keyword">let</span> <span id="23411" data-toggle="tooltip" data-title="(bw: boolean) =&gt; &quot;TOP&quot; | &quot;BOTTOM&quot;">limit</span> <span class="punctuation">=</span> <span class="punctuation">(</span><span id="23421" data-toggle="tooltip" data-title="boolean">bw</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="commands.html#23421"><span data-toggle="tooltip" data-title="boolean">bw</span></a> <span class="punctuation">?</span> <span class="string">&quot;TOP&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;BOTTOM&quot;</span>
                <a href="commands.html#4586"><span data-toggle="tooltip" data-title="string | null">searchInfo</span></a> <span class="punctuation">=</span>
                    <span class="string">`Search hit ${</span><a href="commands.html#23411"><span data-toggle="tooltip" data-title="(bw: boolean) =&gt; &quot;TOP&quot; | &quot;BOTTOM&quot;">limit</span></a><span class="punctuation">(</span><a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a><span class="punctuation">)</span><span class="string">} continuing at ${</span>
                    <a href="commands.html#23411"><span data-toggle="tooltip" data-title="(bw: boolean) =&gt; &quot;TOP&quot; | &quot;BOTTOM&quot;">limit</span></a><span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a><span class="punctuation">)</span><span class="string">}`</span>
            <span class="punctuation">}</span>
</code></pre>
<p>If search was successful, we return a new selection to highlight
it. First, we find the start and end position of the match.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>            <span class="keyword">let</span> <span id="23834" data-toggle="tooltip" data-title="number">len</span> <span class="punctuation">=</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span>
            <span class="keyword">let</span> <span id="23877" data-toggle="tooltip" data-title="vscode.Position">start</span> <span class="punctuation">=</span> <a href="commands.html#21640"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(offset: number) =&gt; vscode.Position">positionAt</span><span class="punctuation">(</span><a href="commands.html#22529"><span data-toggle="tooltip" data-title="number">offs</span></a><span class="punctuation">)</span>
            <span class="keyword">let</span> <span id="23923" data-toggle="tooltip" data-title="vscode.Position">end</span> <span class="punctuation">=</span> <a href="commands.html#21640"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(offset: number) =&gt; vscode.Position">positionAt</span><span class="punctuation">(</span><a href="commands.html#22529"><span data-toggle="tooltip" data-title="number">offs</span></a> <span class="punctuation">+</span> <a href="commands.html#23834"><span data-toggle="tooltip" data-title="number">len</span></a><span class="punctuation">)</span>
</code></pre>
<p>If the search direction is backwards, we flip the active and
anchor positions. Normally, the anchor is set to the start and
cursor to the end. Finally, we check if the <code>selectTillMatch</code>
argument is set. If so, we move only the active cursor position
and leave the selection start (anchor) as-is.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>            <span class="keyword">let</span> <span class="punctuation">[</span><span id="24385" data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">,</span> <span id="24392" data-toggle="tooltip" data-title="vscode.Position">anchor</span><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">?</span>
                <span class="punctuation">[</span><a href="commands.html#23877"><span data-toggle="tooltip" data-title="vscode.Position">start</span></a><span class="punctuation">,</span> <a href="commands.html#23923"><span data-toggle="tooltip" data-title="vscode.Position">end</span></a><span class="punctuation">]</span> <span class="punctuation">:</span>
                <span class="punctuation">[</span><a href="commands.html#23923"><span data-toggle="tooltip" data-title="vscode.Position">end</span></a><span class="punctuation">,</span> <a href="commands.html#23877"><span data-toggle="tooltip" data-title="vscode.Position">start</span></a><span class="punctuation">]</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4807"><span data-toggle="tooltip" data-title="boolean">searchSelectTillMatch</span></a><span class="punctuation">)</span>
                <a href="commands.html#24392"><span data-toggle="tooltip" data-title="vscode.Position">anchor</span></a> <span class="punctuation">=</span> <a href="commands.html#22064"><span data-toggle="tooltip" data-title="vscode.Selection">sel</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">anchor</span>
            <span class="keyword">return</span> <span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Selection">Selection</span><span class="punctuation">(</span><a href="commands.html#24392"><span data-toggle="tooltip" data-title="vscode.Position">anchor</span></a><span class="punctuation">,</span> <a href="commands.html#24385"><span data-toggle="tooltip" data-title="vscode.Position">active</span></a><span class="punctuation">)</span>
        <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <a href="commands.html#21177"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range: vscode.Range, revealType?: vscode.TextEditorRevealType) =&gt; void">revealRange</span><span class="punctuation">(</span><a href="commands.html#21177"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="accepting-search">Accepting Search</h3>
<p>Accepting the search resets the mode variables. Additionally, if
<code>typeAfterAccept</code> argument is set we run the given normal mode commands.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="24680" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">acceptSearch</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#17242"><span class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setSearching</span></a><span class="punctuation">(</span><span class="keyword">false</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4842"><span data-toggle="tooltip" data-title="string | undefined">searchTypeAfterAccept</span></a><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="commands.html#31484"><span class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="24987" data-toggle="tooltip" data-title="string">keys</span><span class="punctuation">:</span> <a href="commands.html#4842"><span data-toggle="tooltip" data-title="string">searchTypeAfterAccept</span></a> <span class="punctuation">}</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="canceling-search">Canceling Search</h3>
<p>Canceling search just resets state, and moves the cursor back to the starting
position.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="25021" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">cancelSearch</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4452"><span data-toggle="tooltip" data-title="boolean">searching</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <a href="commands.html#17242"><span class="member" data-toggle="tooltip" data-title="(value: boolean) =&gt; Promise&lt;void&gt;">setSearching</span></a><span class="punctuation">(</span><span class="keyword">false</span><span class="punctuation">)</span>
        <span class="keyword">let</span> <span id="25274" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#25274"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <a href="commands.html#25274"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span> <span class="punctuation">=</span> <a href="commands.html#4539"><span data-toggle="tooltip" data-title="vscode.Selection[]">searchStartSelections</span></a>
            <a href="commands.html#25274"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range: vscode.Range, revealType?: vscode.TextEditorRevealType) =&gt; void">revealRange</span><span class="punctuation">(</span><a href="commands.html#25274"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="modifying-search-string">Modifying Search String</h3>
<p>Since we cannot capture the backspace character in normal mode, we have to
hook it some other way. We define a command <code>modaledit.deleteCharFromSearch</code>
which deletes the last character from the search string. This command can
then be bound to backspace using the standard keybindings. We only run the
command, if the <code>modaledit.searching</code> context is set. Below is an excerpt
of the default keybindings defined in <code>package.json</code>.</p>

<pre class="syntaxhighlight narrow-scrollbars"><code>{
   <span class="string">&quot;key&quot;</span>: <span class="string">&quot;Backspace&quot;</span>,
   <span class="string">&quot;command&quot;</span>: <span class="string">&quot;modaledit.deleteCharFromSearch&quot;</span>,
   <span class="string">&quot;when&quot;</span>: <span class="string">&quot;editorTextFocus &amp;&amp; modaledit.searching&quot;</span>
}
</code></pre>
<p>Note that we need to also update the status bar to show the modified search
string. The <code>onType</code> callback that normally handles this is not getting
called when this command is invoked.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="25463" class="member" data-toggle="tooltip" data-title="() =&gt; void">deleteCharFromSearch</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="26368" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#26368"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a> <span class="punctuation">&amp;&amp;</span> <a href="commands.html#4452"><span data-toggle="tooltip" data-title="boolean">searching</span></a> <span class="punctuation">&amp;&amp;</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">&gt;</span> <span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a> <span class="punctuation">=</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(start?: number, end?: number) =&gt; string">slice</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">-</span> <span class="number">1</span><span class="punctuation">)</span>
        <a href="commands.html#20545"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, selections: vscode.Selection[]) =&gt; void">highlightMatches</span></a><span class="punctuation">(</span><a href="commands.html#26368"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <a href="commands.html#4539"><span data-toggle="tooltip" data-title="vscode.Selection[]">searchStartSelections</span></a><span class="punctuation">)</span>
        <a href="commands.html#12803"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor | undefined, help?: string) =&gt; void">updateCursorAndStatusBar</span></a><span class="punctuation">(</span><a href="commands.html#26368"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h3 id="finding-previous-and-next-match">Finding Previous and Next Match</h3>
<p>Using the <code>highlightMatches</code> function finding next and previous match is a
relatively simple task. We basically just restart the search from
the current cursor position(s).</p>
<p>We also check whether the search parameters include <code>typeBeforeNextMatch</code> or
<code>typeAfterNextMatch</code> argument. If so, we invoke the user-specified commands
before and/or after we jump to the next match.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="26647" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">nextMatch</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="27156" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#27156"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a> <span class="punctuation">&amp;&amp;</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4889"><span data-toggle="tooltip" data-title="string | undefined">searchTypeBeforeNextMatch</span></a><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="commands.html#31484"><span class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="27307" data-toggle="tooltip" data-title="string">keys</span><span class="punctuation">:</span> <a href="commands.html#4889"><span data-toggle="tooltip" data-title="string">searchTypeBeforeNextMatch</span></a> <span class="punctuation">}</span><span class="punctuation">)</span>
        <a href="commands.html#20545"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, selections: vscode.Selection[]) =&gt; void">highlightMatches</span></a><span class="punctuation">(</span><a href="commands.html#27156"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <span class="typename" data-toggle="tooltip" data-title="ArrayConstructor">Array</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(arrayLike: ArrayLike&lt;T&gt;): T[]; &lt;T, U&gt;(arrayLike: ArrayLike&lt;T&gt;, mapfn: (v: T, k: number) =&gt; U, thisArg?: any): U[]; &lt;T&gt;(iterable: Iterable&lt;T&gt; | ArrayLike&lt;T&gt;): T[]; &lt;T, U&gt;(iterable: Iterable&lt;T&gt; | ArrayLike&lt;T&gt;, mapfn: (v: T, k: number) =&gt; U, thisArg?: any): U[]; }">from</span><span class="punctuation">(</span><a href="commands.html#27156"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4940"><span data-toggle="tooltip" data-title="string | undefined">searchTypeAfterNextMatch</span></a><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="commands.html#31484"><span class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="27482" data-toggle="tooltip" data-title="string">keys</span><span class="punctuation">:</span> <a href="commands.html#4940"><span data-toggle="tooltip" data-title="string">searchTypeAfterNextMatch</span></a> <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>When finding the previous match we flip the search direction but otherwise do
the same routine as in the previous function.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="27526" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">previousMatch</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="27726" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#27726"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a> <span class="punctuation">&amp;&amp;</span> <a href="commands.html#4513"><span data-toggle="tooltip" data-title="string">searchString</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#4990"><span data-toggle="tooltip" data-title="string | undefined">searchTypeBeforePreviousMatch</span></a><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="commands.html#31484"><span class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="27881" data-toggle="tooltip" data-title="string">keys</span><span class="punctuation">:</span> <a href="commands.html#4990"><span data-toggle="tooltip" data-title="string">searchTypeBeforePreviousMatch</span></a> <span class="punctuation">}</span><span class="punctuation">)</span>
        <a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">=</span> <span class="punctuation">!</span><a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a>
        <a href="commands.html#20545"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, selections: vscode.Selection[]) =&gt; void">highlightMatches</span></a><span class="punctuation">(</span><a href="commands.html#27726"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <span class="typename" data-toggle="tooltip" data-title="ArrayConstructor">Array</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(arrayLike: ArrayLike&lt;T&gt;): T[]; &lt;T, U&gt;(arrayLike: ArrayLike&lt;T&gt;, mapfn: (v: T, k: number) =&gt; U, thisArg?: any): U[]; &lt;T&gt;(iterable: Iterable&lt;T&gt; | ArrayLike&lt;T&gt;): T[]; &lt;T, U&gt;(iterable: Iterable&lt;T&gt; | ArrayLike&lt;T&gt;, mapfn: (v: T, k: number) =&gt; U, thisArg?: any): U[]; }">from</span><span class="punctuation">(</span><a href="commands.html#27726"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a> <span class="punctuation">=</span> <span class="punctuation">!</span><a href="commands.html#4665"><span data-toggle="tooltip" data-title="boolean">searchBackwards</span></a>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#5045"><span data-toggle="tooltip" data-title="string | undefined">searchTypeAfterPreviousMatch</span></a><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="commands.html#31484"><span class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="28152" data-toggle="tooltip" data-title="string">keys</span><span class="punctuation">:</span> <a href="commands.html#5045"><span data-toggle="tooltip" data-title="string">searchTypeAfterPreviousMatch</span></a> <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="bookmarks">Bookmarks</h2>
<p>Defining a bookmark is simple. We just store the cursor location and file in
a <code>Bookmark</code> object, and store it in the <code>bookmarks</code> array.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="28200" class="member" data-toggle="tooltip" data-title="(args?: BookmarkArgs) =&gt; void">defineBookmark</span><span class="punctuation">(</span><span id="28402" data-toggle="tooltip" data-title="BookmarkArgs | undefined">args</span><span class="punctuation">?</span><span class="punctuation">:</span> <a href="commands.html#1032"><span class="typename" data-toggle="tooltip" data-title="BookmarkArgs">BookmarkArgs</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="28433" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#28433"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="28505" data-toggle="tooltip" data-title="string">label</span> <span class="punctuation">=</span> <a href="commands.html#28402"><span data-toggle="tooltip" data-title="BookmarkArgs | undefined">args</span></a><span class="punctuation">?.</span><a href="commands.html#1299"><span data-toggle="tooltip" data-title="string | undefined">bookmark</span></a><span class="punctuation">?.</span><span class="member" data-toggle="tooltip" data-title="(() =&gt; string) | undefined">toString</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">||</span> <span class="string">&#039;0&#039;</span>
        <span class="keyword">let</span> <span id="28560" data-toggle="tooltip" data-title="vscode.TextDocument">document</span> <span class="punctuation">=</span> <a href="commands.html#28433"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span>
        <span class="keyword">let</span> <span id="28600" data-toggle="tooltip" data-title="vscode.Position">position</span> <span class="punctuation">=</span> <a href="commands.html#28433"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span>
        <a href="commands.html#5173"><span data-toggle="tooltip" data-title="{ [label: string]: Bookmark; }">bookmarks</span></a><span class="punctuation">[</span><a href="commands.html#28505"><span data-toggle="tooltip" data-title="string">label</span></a><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="commands.html#1348"><span class="typename" data-toggle="tooltip" data-title="typeof Bookmark">Bookmark</span></a><span class="punctuation">(</span><a href="commands.html#28505"><span data-toggle="tooltip" data-title="string">label</span></a><span class="punctuation">,</span> <a href="commands.html#28560"><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span></a><span class="punctuation">,</span> <a href="commands.html#28600"><span data-toggle="tooltip" data-title="vscode.Position">position</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>Jumping to bookmark is also easy, just call the <code>changeSelection</code> function
we already defined. It makes sure that selection is visible.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="28713" class="member" data-toggle="tooltip" data-title="(args?: BookmarkArgs) =&gt; Promise&lt;void&gt;">goToBookmark</span><span class="punctuation">(</span><span id="28897" data-toggle="tooltip" data-title="BookmarkArgs | undefined">args</span><span class="punctuation">?</span><span class="punctuation">:</span> <a href="commands.html#1032"><span class="typename" data-toggle="tooltip" data-title="BookmarkArgs">BookmarkArgs</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="28943" data-toggle="tooltip" data-title="string">label</span> <span class="punctuation">=</span> <a href="commands.html#28897"><span data-toggle="tooltip" data-title="BookmarkArgs | undefined">args</span></a><span class="punctuation">?.</span><a href="commands.html#1299"><span data-toggle="tooltip" data-title="string | undefined">bookmark</span></a><span class="punctuation">?.</span><span class="member" data-toggle="tooltip" data-title="(() =&gt; string) | undefined">toString</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">||</span> <span class="string">&#039;0&#039;</span>
    <span class="keyword">let</span> <span id="28994" data-toggle="tooltip" data-title="Bookmark">bm</span> <span class="punctuation">=</span> <a href="commands.html#5173"><span data-toggle="tooltip" data-title="{ [label: string]: Bookmark; }">bookmarks</span></a><span class="punctuation">[</span><a href="commands.html#28943"><span data-toggle="tooltip" data-title="string">label</span></a><span class="punctuation">]</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#28994"><span data-toggle="tooltip" data-title="Bookmark">bm</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (document: vscode.TextDocument, column?: vscode.ViewColumn, preserveFocus?: boolean): Thenable&lt;vscode.TextEditor&gt;; (document: vscode.TextDocument, options?: vscode.TextDocumentShowOptions): Thenable&lt;vscode.TextEditor&gt;; (uri: vscode.Uri, options?: vscode.TextDocumentShowOptions): Thenable&lt;vscode.TextEditor&gt;; }">showTextDocument</span><span class="punctuation">(</span><a href="commands.html#28994"><span data-toggle="tooltip" data-title="Bookmark">bm</span></a><span class="punctuation">.</span><a href="commands.html#1483"><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span></a><span class="punctuation">)</span>
        <span class="keyword">let</span> <span id="29103" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#29103"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#28897"><span data-toggle="tooltip" data-title="BookmarkArgs | undefined">args</span></a><span class="punctuation">?.</span><a href="commands.html#1323"><span data-toggle="tooltip" data-title="boolean | undefined">select</span></a><span class="punctuation">)</span>
                <a href="commands.html#29843"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, anchor: vscode.Position, active: vscode.Position) =&gt; void">changeSelection</span></a><span class="punctuation">(</span><a href="commands.html#29103"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <a href="commands.html#29103"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">anchor</span><span class="punctuation">,</span> <a href="commands.html#28994"><span data-toggle="tooltip" data-title="Bookmark">bm</span></a><span class="punctuation">.</span><a href="commands.html#1530"><span data-toggle="tooltip" data-title="vscode.Position">position</span></a><span class="punctuation">)</span>
            <span class="keyword">else</span>
                <a href="commands.html#29843"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, anchor: vscode.Position, active: vscode.Position) =&gt; void">changeSelection</span></a><span class="punctuation">(</span><a href="commands.html#29103"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <a href="commands.html#28994"><span data-toggle="tooltip" data-title="Bookmark">bm</span></a><span class="punctuation">.</span><a href="commands.html#1530"><span data-toggle="tooltip" data-title="vscode.Position">position</span></a><span class="punctuation">,</span> <a href="commands.html#28994"><span data-toggle="tooltip" data-title="Bookmark">bm</span></a><span class="punctuation">.</span><a href="commands.html#1530"><span data-toggle="tooltip" data-title="vscode.Position">position</span></a><span class="punctuation">)</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>To show the list of bookmarks in the command menu, we provide a new command.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="29382" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">showBookmarks</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="29531" data-toggle="tooltip" data-title="Bookmark[]">items</span> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" data-title="ObjectConstructor">Object</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(o: any) =&gt; string[]">getOwnPropertyNames</span><span class="punctuation">(</span><a href="commands.html#5173"><span data-toggle="tooltip" data-title="{ [label: string]: Bookmark; }">bookmarks</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(callbackfn: (value: string, index: number, array: string[]) =&gt; U, thisArg?: any) =&gt; U[]">map</span><span class="punctuation">(</span><span id="29582" data-toggle="tooltip" data-title="string">name</span> <span class="punctuation">=&gt;</span> <a href="commands.html#5173"><span data-toggle="tooltip" data-title="{ [label: string]: Bookmark; }">bookmarks</span></a><span class="punctuation">[</span><a href="commands.html#29582"><span data-toggle="tooltip" data-title="string">name</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="29615" data-toggle="tooltip" data-title="Bookmark | undefined">selected</span> <span class="punctuation">=</span> <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (items: readonly string[] | Thenable&lt;readonly string[]&gt;, options: vscode.QuickPickOptions &amp; { canPickMany: true; }, token?: vscode.CancellationToken): Thenable&lt;string[] | undefined&gt;; (items: readonly string[] | Thenable&lt;readonly string[]&gt;, options?: vscode.QuickPickOptions, token?: vscode.CancellationToken): Thena...">showQuickPick</span><span class="punctuation">(</span><a href="commands.html#29531"><span data-toggle="tooltip" data-title="Bookmark[]">items</span></a><span class="punctuation">,</span> <span class="punctuation">{</span>
        <span id="29669" data-toggle="tooltip" data-title="string">placeHolder</span><span class="punctuation">:</span> <span class="string">&quot;Select bookmark to jump to&quot;</span><span class="punctuation">,</span>
        <span id="29721" data-toggle="tooltip" data-title="true">matchOnDescription</span><span class="punctuation">:</span> <span class="keyword">true</span>
    <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#29615"><span data-toggle="tooltip" data-title="Bookmark | undefined">selected</span></a><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="commands.html#28713"><span class="member" data-toggle="tooltip" data-title="(args?: BookmarkArgs) =&gt; Promise&lt;void&gt;">goToBookmark</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="29812" data-toggle="tooltip" data-title="string">bookmark</span><span class="punctuation">:</span> <a href="commands.html#29615"><span data-toggle="tooltip" data-title="Bookmark">selected</span></a><span class="punctuation">.</span><a href="commands.html#1452"><span data-toggle="tooltip" data-title="string">label</span></a> <span class="punctuation">}</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>This helper function changes the selection range in the active editor. It
also makes sure that the selection is visible.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="29843" class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, anchor: vscode.Position, active: vscode.Position) =&gt; void">changeSelection</span><span class="punctuation">(</span><span id="30009" data-toggle="tooltip" data-title="vscode.TextEditor">editor</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditor">TextEditor</span><span class="punctuation">,</span> <span id="30035" data-toggle="tooltip" data-title="vscode.Position">anchor</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Position">Position</span><span class="punctuation">,</span>
    <span id="30060" data-toggle="tooltip" data-title="vscode.Position">active</span><span class="punctuation">:</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.Position">Position</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="commands.html#30009"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Selection">Selection</span><span class="punctuation">(</span><a href="commands.html#30035"><span data-toggle="tooltip" data-title="vscode.Position">anchor</span></a><span class="punctuation">,</span> <a href="commands.html#30060"><span data-toggle="tooltip" data-title="vscode.Position">active</span></a><span class="punctuation">)</span>
    <a href="commands.html#30009"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range: vscode.Range, revealType?: vscode.TextEditorRevealType) =&gt; void">revealRange</span><span class="punctuation">(</span><a href="commands.html#30009"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="quick-snippets">Quick Snippets</h2>
<p>Supporting quick snippets is also a pleasantly simple job. First we implement
the <code>modaledit.fillSnippetArgs</code> command, which replaces (multi-)selection
ranges with <code>$1</code>, <code>$2</code>, ...</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="30198" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">fillSnippetArgs</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="30486" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#30486"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="30558" data-toggle="tooltip" data-title="readonly vscode.Selection[]">sel</span> <span class="punctuation">=</span> <a href="commands.html#30486"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">selections</span>
        <span class="keyword">await</span> <a href="commands.html#30486"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callback: (editBuilder: vscode.TextEditorEdit) =&gt; void, options?: { readonly undoStopBefore: boolean; readonly undoStopAfter: boolean; }) =&gt; Thenable&lt;boolean&gt;">edit</span><span class="punctuation">(</span><span id="30610" data-toggle="tooltip" data-title="vscode.TextEditorEdit">eb</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="30639" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">0</span><span class="punctuation">;</span> <a href="commands.html#30639"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;</span> <a href="commands.html#30558"><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">sel</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">;</span> <a href="commands.html#30639"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span><span class="punctuation">)</span>
                <a href="commands.html#30610"><span data-toggle="tooltip" data-title="vscode.TextEditorEdit">eb</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(location: vscode.Position | vscode.Range | vscode.Selection, value: string) =&gt; void">replace</span><span class="punctuation">(</span><a href="commands.html#30558"><span data-toggle="tooltip" data-title="readonly vscode.Selection[]">sel</span></a><span class="punctuation">[</span><a href="commands.html#30639"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span><span class="punctuation">,</span> <span class="string">&quot;$&quot;</span> <span class="punctuation">+</span> <span class="punctuation">(</span><a href="commands.html#30639"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>Defining a snippet just puts the selection into an array.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="30740" class="member" data-toggle="tooltip" data-title="(args?: QuickSnippetArgs) =&gt; void">defineQuickSnippet</span><span class="punctuation">(</span><span id="30842" data-toggle="tooltip" data-title="QuickSnippetArgs | undefined">args</span><span class="punctuation">?</span><span class="punctuation">:</span> <a href="commands.html#1760"><span class="typename" data-toggle="tooltip" data-title="QuickSnippetArgs">QuickSnippetArgs</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="30877" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#30877"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span>
        <a href="commands.html#5295"><span data-toggle="tooltip" data-title="string[]">quickSnippets</span></a><span class="punctuation">[</span><a href="commands.html#30842"><span data-toggle="tooltip" data-title="QuickSnippetArgs | undefined">args</span></a><span class="punctuation">?.</span><a href="commands.html#1955"><span data-toggle="tooltip" data-title="number | undefined">snippet</span></a> <span class="punctuation">||</span> <span class="number">0</span><span class="punctuation">]</span> <span class="punctuation">=</span>
            <a href="commands.html#30877"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><a href="commands.html#30877"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>Inserting a snippet is done as easily with the built-in command. We enter
insert mode automatically before snippet is expanded.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="31037" class="member" data-toggle="tooltip" data-title="(args?: QuickSnippetArgs) =&gt; Promise&lt;void&gt;">insertQuickSnippet</span><span class="punctuation">(</span><span id="31219" data-toggle="tooltip" data-title="QuickSnippetArgs | undefined">args</span><span class="punctuation">?</span><span class="punctuation">:</span> <a href="commands.html#1760"><span class="typename" data-toggle="tooltip" data-title="QuickSnippetArgs">QuickSnippetArgs</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="31269" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <a href="commands.html#31219"><span data-toggle="tooltip" data-title="QuickSnippetArgs | undefined">args</span></a><span class="punctuation">?.</span><a href="commands.html#1955"><span data-toggle="tooltip" data-title="number | undefined">snippet</span></a> <span class="punctuation">||</span> <span class="number">0</span>
    <span class="keyword">let</span> <span id="31301" data-toggle="tooltip" data-title="string">snippet</span> <span class="punctuation">=</span> <a href="commands.html#5295"><span data-toggle="tooltip" data-title="string[]">quickSnippets</span></a><span class="punctuation">[</span><a href="commands.html#31269"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#31301"><span data-toggle="tooltip" data-title="string">snippet</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="commands.html#11519"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">enterInsert</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><span class="string">&quot;editor.action.insertSnippet&quot;</span><span class="punctuation">,</span>
            <span class="punctuation">{</span> <span id="31463" data-toggle="tooltip" data-title="string">snippet</span> <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="invoking-commands-via-key-bindings">Invoking Commands via Key Bindings</h2>
<p>The last command runs normal mode commands throught their key bindings.
Implementing that is as easy as calling the keyboard handler.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="31484" class="member" data-toggle="tooltip" data-title="(args: TypeNormalKeysArgs) =&gt; Promise&lt;void&gt;">typeNormalKeys</span><span class="punctuation">(</span><span id="31714" data-toggle="tooltip" data-title="TypeNormalKeysArgs">args</span><span class="punctuation">:</span> <a href="commands.html#1979"><span class="typename" data-toggle="tooltip" data-title="TypeNormalKeysArgs">TypeNormalKeysArgs</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="commands.html#31714"><span data-toggle="tooltip" data-title="TypeNormalKeysArgs">args</span></a> <span class="punctuation">!==</span> <span class="string">&#039;object&#039;</span> <span class="punctuation">||</span> <span class="keyword">typeof</span> <span class="punctuation">(</span><a href="commands.html#31714"><span data-toggle="tooltip" data-title="TypeNormalKeysArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#2172"><span data-toggle="tooltip" data-title="string">keys</span></a><span class="punctuation">)</span> <span class="punctuation">!==</span> <span class="string">&#039;string&#039;</span><span class="punctuation">)</span>
        <span class="keyword">throw</span> <span class="typename" data-toggle="tooltip" data-title="ErrorConstructor">Error</span><span class="punctuation">(</span><span class="string">`${</span><a href="commands.html#6736"><span data-toggle="tooltip" data-title="&quot;modaledit.typeNormalKeys&quot;">typeNormalKeysId</span></a><span class="string">}: Invalid args: ${</span><span class="typename" data-toggle="tooltip" data-title="JSON">JSON</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (value: any, replacer?: (this: any, key: string, value: any) =&gt; any, space?: string | number): string; (value: any, replacer?: (number | string)[] | null, space?: string | number): string; }">stringify</span><span class="punctuation">(</span><a href="commands.html#31714"><span data-toggle="tooltip" data-title="TypeNormalKeysArgs">args</span></a><span class="punctuation">)</span><span class="string">}`</span><span class="punctuation">)</span>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="31923" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">0</span><span class="punctuation">;</span> <a href="commands.html#31923"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;</span> <a href="commands.html#31714"><span data-toggle="tooltip" data-title="TypeNormalKeysArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#2172"><span data-toggle="tooltip" data-title="string">keys</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">;</span> <a href="commands.html#31923"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="commands.html#10200"><span class="member" data-toggle="tooltip" data-title="(key: string) =&gt; Promise&lt;boolean&gt;">runActionForKey</span></a><span class="punctuation">(</span><a href="commands.html#31714"><span data-toggle="tooltip" data-title="TypeNormalKeysArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#2172"><span data-toggle="tooltip" data-title="string">keys</span></a><span class="punctuation">[</span><a href="commands.html#31923"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="advanced-selection-command">Advanced Selection Command</h2>
<p>For selecting ranges of text between two characters (inside parenthesis, for
example) we add the <code>modaledit.selectBetween</code> command. See the
<a href="../README.html#selecting-text-between-delimiters">instructions</a> for the list
of parameters this command provides.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="32005" class="member" data-toggle="tooltip" data-title="(args: SelectBetweenArgs) =&gt; void">selectBetween</span><span class="punctuation">(</span><span id="32349" data-toggle="tooltip" data-title="SelectBetweenArgs">args</span><span class="punctuation">:</span> <a href="commands.html#2193"><span class="typename" data-toggle="tooltip" data-title="SelectBetweenArgs">SelectBetweenArgs</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="32384" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#32384"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span>
        <span class="keyword">return</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a> <span class="punctuation">!==</span> <span class="string">&#039;object&#039;</span><span class="punctuation">)</span>
        <span class="keyword">throw</span> <span class="typename" data-toggle="tooltip" data-title="ErrorConstructor">Error</span><span class="punctuation">(</span><span class="string">`${</span><a href="commands.html#6789"><span data-toggle="tooltip" data-title="&quot;modaledit.selectBetween&quot;">selectBetweenId</span></a><span class="string">}: Invalid args: ${</span><span class="typename" data-toggle="tooltip" data-title="JSON">JSON</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (value: any, replacer?: (this: any, key: string, value: any) =&gt; any, space?: string | number): string; (value: any, replacer?: (number | string)[] | null, space?: string | number): string; }">stringify</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="never">args</span></a><span class="punctuation">)</span><span class="string">}`</span><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="32584" data-toggle="tooltip" data-title="vscode.TextDocument">doc</span> <span class="punctuation">=</span> <a href="commands.html#32384"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span>
</code></pre>
<p>Get position of cursor and anchor. These positions might be in &quot;reverse&quot;
order (cursor lies before anchor), so we need to sort them into <code>lowPos</code>
and <code>highPos</code> variables and corresponding offset variables. These are
used to determine the search range later on.</p>
<p>Since <code>to</code> or <code>from</code> parameter might be missing, we initialize the
<code>fromOffs</code> and <code>toOffs</code> variables to low and high offsets. They delimit
the range to be selected at the end.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>    <span class="keyword">let</span> <span id="33134" data-toggle="tooltip" data-title="vscode.Position">cursorPos</span> <span class="punctuation">=</span> <a href="commands.html#32384"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span>
    <span class="keyword">let</span> <span id="33179" data-toggle="tooltip" data-title="vscode.Position">anchorPos</span> <span class="punctuation">=</span> <a href="commands.html#32384"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">anchor</span>
    <span class="keyword">let</span> <span class="punctuation">[</span><span id="33226" data-toggle="tooltip" data-title="vscode.Position">highPos</span><span class="punctuation">,</span> <span id="33234" data-toggle="tooltip" data-title="vscode.Position">lowPos</span><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="commands.html#33134"><span data-toggle="tooltip" data-title="vscode.Position">cursorPos</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(other: vscode.Position) =&gt; boolean">isAfterOrEqual</span><span class="punctuation">(</span><a href="commands.html#33179"><span data-toggle="tooltip" data-title="vscode.Position">anchorPos</span></a><span class="punctuation">)</span> <span class="punctuation">?</span>
        <span class="punctuation">[</span><a href="commands.html#33134"><span data-toggle="tooltip" data-title="vscode.Position">cursorPos</span></a><span class="punctuation">,</span> <a href="commands.html#33179"><span data-toggle="tooltip" data-title="vscode.Position">anchorPos</span></a><span class="punctuation">]</span> <span class="punctuation">:</span> <span class="punctuation">[</span><a href="commands.html#33179"><span data-toggle="tooltip" data-title="vscode.Position">anchorPos</span></a><span class="punctuation">,</span> <a href="commands.html#33134"><span data-toggle="tooltip" data-title="vscode.Position">cursorPos</span></a><span class="punctuation">]</span>
    <span class="keyword">let</span> <span id="33348" data-toggle="tooltip" data-title="number">highOffs</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(position: vscode.Position) =&gt; number">offsetAt</span><span class="punctuation">(</span><a href="commands.html#33226"><span data-toggle="tooltip" data-title="vscode.Position">highPos</span></a><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="33390" data-toggle="tooltip" data-title="number">lowOffs</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(position: vscode.Position) =&gt; number">offsetAt</span><span class="punctuation">(</span><a href="commands.html#33234"><span data-toggle="tooltip" data-title="vscode.Position">lowPos</span></a><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="33430" data-toggle="tooltip" data-title="number">fromOffs</span> <span class="punctuation">=</span> <a href="commands.html#33390"><span data-toggle="tooltip" data-title="number">lowOffs</span></a>
    <span class="keyword">let</span> <span id="33458" data-toggle="tooltip" data-title="number">toOffs</span> <span class="punctuation">=</span> <a href="commands.html#33348"><span data-toggle="tooltip" data-title="number">highOffs</span></a>
</code></pre>
<p>Next we determine the search range. The <code>startOffs</code> marks the starting
offset and <code>endOffs</code> the end. Depending on the specified scope these
variables are either set to start/end of the current line or the whole
document.</p>
<p>In the actual search, we have two main branches: one for the case when
regex search is used and another for the normal text search.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>    <span class="keyword">let</span> <span id="33912" data-toggle="tooltip" data-title="vscode.Position">startPos</span> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Position">Position</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3357"><span data-toggle="tooltip" data-title="boolean">docScope</span></a> <span class="punctuation">?</span> <span class="number">0</span> <span class="punctuation">:</span> <a href="commands.html#33234"><span data-toggle="tooltip" data-title="vscode.Position">lowPos</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">line</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="33988" data-toggle="tooltip" data-title="vscode.Position">endPos</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (line: number): vscode.TextLine; (position: vscode.Position): vscode.TextLine; }">lineAt</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3357"><span data-toggle="tooltip" data-title="boolean">docScope</span></a> <span class="punctuation">?</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">lineCount</span> <span class="punctuation">-</span> <span class="number">1</span> <span class="punctuation">:</span> <a href="commands.html#33226"><span data-toggle="tooltip" data-title="vscode.Position">highPos</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">line</span><span class="punctuation">)</span>
        <span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Range">range</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">end</span>
    <span class="keyword">let</span> <span id="34087" data-toggle="tooltip" data-title="number">startOffs</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(position: vscode.Position) =&gt; number">offsetAt</span><span class="punctuation">(</span><a href="commands.html#33912"><span data-toggle="tooltip" data-title="vscode.Position">startPos</span></a><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="34131" data-toggle="tooltip" data-title="number">endOffs</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(position: vscode.Position) =&gt; number">offsetAt</span><span class="punctuation">(</span><a href="commands.html#33988"><span data-toggle="tooltip" data-title="vscode.Position">endPos</span></a><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3285"><span data-toggle="tooltip" data-title="boolean">regex</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3251"><span data-toggle="tooltip" data-title="string">from</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
</code></pre>
<p>This branch searches for regex in the <code>from</code> parameter starting
from <code>startPos</code> continuing until <code>lowPos</code>. We need to find the
last occurrence of the regex, so we have to add a global modifier
<code>g</code> and iterate through all the matches. In case there are no
matches <code>fromOffs</code> gets the same offset as <code>startOffs</code> meaning
that the selection will extend to the start of the search scope.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>            <a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a>
            <span class="keyword">let</span> <span id="34775" data-toggle="tooltip" data-title="string">text</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Range">Range</span><span class="punctuation">(</span><a href="commands.html#33912"><span data-toggle="tooltip" data-title="vscode.Position">startPos</span></a><span class="punctuation">,</span> <a href="commands.html#33234"><span data-toggle="tooltip" data-title="vscode.Position">lowPos</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
            <span class="keyword">let</span> <span id="34847" data-toggle="tooltip" data-title="RegExp">re</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="typename" data-toggle="tooltip" data-title="RegExpConstructor">RegExp</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3251"><span data-toggle="tooltip" data-title="string">from</span></a><span class="punctuation">,</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3329"><span data-toggle="tooltip" data-title="boolean">caseSensitive</span></a> <span class="punctuation">?</span> <span class="string">&quot;g&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;gi&quot;</span><span class="punctuation">)</span>
            <span class="keyword">let</span> <span id="34924" data-toggle="tooltip" data-title="RegExpExecArray | null">match</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="RegExpExecArray">RegExpExecArray</span> <span class="punctuation">|</span> <span class="keyword">null</span> <span class="punctuation">=</span> <span class="keyword">null</span>
            <span class="keyword">while</span> <span class="punctuation">(</span><span class="punctuation">(</span><a href="commands.html#34924"><span data-toggle="tooltip" data-title="RegExpExecArray | null">match</span></a> <span class="punctuation">=</span> <a href="commands.html#34847"><span data-toggle="tooltip" data-title="RegExp">re</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(string: string) =&gt; RegExpExecArray | null">exec</span><span class="punctuation">(</span><a href="commands.html#34775"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">!=</span> <span class="keyword">null</span><span class="punctuation">)</span>
                <a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a> <span class="punctuation">+</span> <a href="commands.html#34924"><span data-toggle="tooltip" data-title="RegExpExecArray">match</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">index</span> <span class="punctuation">+</span>
                    <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3305"><span data-toggle="tooltip" data-title="boolean">inclusive</span></a> <span class="punctuation">?</span> <span class="number">0</span> <span class="punctuation">:</span> <a href="commands.html#34924"><span data-toggle="tooltip" data-title="RegExpExecArray">match</span></a><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3269"><span data-toggle="tooltip" data-title="string">to</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
</code></pre>
<p>This block finds the regex in the <code>to</code> parameter starting from
the range <code>[highPos, endPos]</code>. Since we want to find the first
occurrence, we don't need to iterate over the matches in this
case.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>            <a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#34131"><span data-toggle="tooltip" data-title="number">endOffs</span></a>
            <span class="keyword">let</span> <span id="35502" data-toggle="tooltip" data-title="string">text</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Range">Range</span><span class="punctuation">(</span><a href="commands.html#33226"><span data-toggle="tooltip" data-title="vscode.Position">highPos</span></a><span class="punctuation">,</span> <a href="commands.html#33988"><span data-toggle="tooltip" data-title="vscode.Position">endPos</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
            <span class="keyword">let</span> <span id="35573" data-toggle="tooltip" data-title="RegExp">re</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="typename" data-toggle="tooltip" data-title="RegExpConstructor">RegExp</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3269"><span data-toggle="tooltip" data-title="string">to</span></a><span class="punctuation">,</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3329"><span data-toggle="tooltip" data-title="boolean">caseSensitive</span></a> <span class="punctuation">?</span> <span data-toggle="tooltip" data-title="undefined">undefined</span> <span class="punctuation">:</span> <span class="string">&quot;i&quot;</span><span class="punctuation">)</span>
            <span class="keyword">let</span> <span id="35653" data-toggle="tooltip" data-title="RegExpExecArray | null">match</span> <span class="punctuation">=</span> <a href="commands.html#35573"><span data-toggle="tooltip" data-title="RegExp">re</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(string: string) =&gt; RegExpExecArray | null">exec</span><span class="punctuation">(</span><a href="commands.html#35502"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#35653"><span data-toggle="tooltip" data-title="RegExpExecArray | null">match</span></a><span class="punctuation">)</span>
                <a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#33348"><span data-toggle="tooltip" data-title="number">highOffs</span></a> <span class="punctuation">+</span> <a href="commands.html#35653"><span data-toggle="tooltip" data-title="RegExpExecArray">match</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">index</span> <span class="punctuation">+</span>
                    <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3305"><span data-toggle="tooltip" data-title="boolean">inclusive</span></a> <span class="punctuation">?</span> <a href="commands.html#35653"><span data-toggle="tooltip" data-title="RegExpExecArray">match</span></a><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
    <span class="keyword">else</span> <span class="punctuation">{</span>
</code></pre>
<p>This branch does the regular text search. We retrieve the whole
search range as string and use <code>indexOf</code> and <code>lastIndexOf</code> methods
to find the strings in <code>to</code> and <code>from</code> parameters. Case insensitivity
is done by converting both the search range and search string to
lowercase.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <span class="keyword">let</span> <span id="36216" data-toggle="tooltip" data-title="string">text</span> <span class="punctuation">=</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><span class="keyword">new</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Range">Range</span><span class="punctuation">(</span><a href="commands.html#33912"><span data-toggle="tooltip" data-title="vscode.Position">startPos</span></a><span class="punctuation">,</span> <a href="commands.html#33988"><span data-toggle="tooltip" data-title="vscode.Position">endPos</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3329"><span data-toggle="tooltip" data-title="boolean">caseSensitive</span></a><span class="punctuation">)</span>
            <a href="commands.html#36216"><span data-toggle="tooltip" data-title="string">text</span></a> <span class="punctuation">=</span> <a href="commands.html#36216"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3251"><span data-toggle="tooltip" data-title="string">from</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#36216"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchString: string, position?: number) =&gt; number">lastIndexOf</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3329"><span data-toggle="tooltip" data-title="boolean">caseSensitive</span></a> <span class="punctuation">?</span>
                <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3251"><span data-toggle="tooltip" data-title="string">from</span></a> <span class="punctuation">:</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3251"><span data-toggle="tooltip" data-title="string">from</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> <a href="commands.html#33390"><span data-toggle="tooltip" data-title="number">lowOffs</span></a> <span class="punctuation">-</span> <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a><span class="punctuation">)</span>
            <a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a> <span class="punctuation">&lt;</span> <span class="number">0</span> <span class="punctuation">?</span> <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a> <span class="punctuation">:</span>
                <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a> <span class="punctuation">+</span> <a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a> <span class="punctuation">+</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3305"><span data-toggle="tooltip" data-title="boolean">inclusive</span></a> <span class="punctuation">?</span> <span class="number">0</span> <span class="punctuation">:</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3251"><span data-toggle="tooltip" data-title="string">from</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3269"><span data-toggle="tooltip" data-title="string">to</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#36216"><span data-toggle="tooltip" data-title="string">text</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchString: string, position?: number) =&gt; number">indexOf</span><span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3329"><span data-toggle="tooltip" data-title="boolean">caseSensitive</span></a> <span class="punctuation">?</span>
                <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3269"><span data-toggle="tooltip" data-title="string">to</span></a> <span class="punctuation">:</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3269"><span data-toggle="tooltip" data-title="string">to</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> <a href="commands.html#33348"><span data-toggle="tooltip" data-title="number">highOffs</span></a> <span class="punctuation">-</span> <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a><span class="punctuation">)</span>
            <a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a> <span class="punctuation">=</span> <a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a> <span class="punctuation">&lt;</span> <span class="number">0</span> <span class="punctuation">?</span> <a href="commands.html#34131"><span data-toggle="tooltip" data-title="number">endOffs</span></a> <span class="punctuation">:</span>
                <a href="commands.html#34087"><span data-toggle="tooltip" data-title="number">startOffs</span></a> <span class="punctuation">+</span> <a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a> <span class="punctuation">+</span> <span class="punctuation">(</span><a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3305"><span data-toggle="tooltip" data-title="boolean">inclusive</span></a> <span class="punctuation">?</span> <a href="commands.html#32349"><span data-toggle="tooltip" data-title="SelectBetweenArgs">args</span></a><span class="punctuation">.</span><a href="commands.html#3269"><span data-toggle="tooltip" data-title="string">to</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#33134"><span data-toggle="tooltip" data-title="vscode.Position">cursorPos</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(other: vscode.Position) =&gt; boolean">isAfterOrEqual</span><span class="punctuation">(</span><a href="commands.html#33179"><span data-toggle="tooltip" data-title="vscode.Position">anchorPos</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
</code></pre>
<p>The last thing to do is to select the range from <code>fromOffs</code> to
<code>toOffs</code>. We want to preserve the direction of the selection. If
it was reserved when this command was called, we flip the variables.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>        <a href="commands.html#29843"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, anchor: vscode.Position, active: vscode.Position) =&gt; void">changeSelection</span></a><span class="punctuation">(</span><a href="commands.html#32384"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(offset: number) =&gt; vscode.Position">positionAt</span><span class="punctuation">(</span><a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a><span class="punctuation">)</span><span class="punctuation">,</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(offset: number) =&gt; vscode.Position">positionAt</span><span class="punctuation">(</span><a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
    <span class="keyword">else</span>
        <a href="commands.html#29843"><span class="member" data-toggle="tooltip" data-title="(editor: vscode.TextEditor, anchor: vscode.Position, active: vscode.Position) =&gt; void">changeSelection</span></a><span class="punctuation">(</span><a href="commands.html#32384"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">,</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(offset: number) =&gt; vscode.Position">positionAt</span><span class="punctuation">(</span><a href="commands.html#33458"><span data-toggle="tooltip" data-title="number">toOffs</span></a><span class="punctuation">)</span><span class="punctuation">,</span> <a href="commands.html#32584"><span data-toggle="tooltip" data-title="vscode.TextDocument">doc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(offset: number) =&gt; vscode.Position">positionAt</span><span class="punctuation">(</span><a href="commands.html#33430"><span data-toggle="tooltip" data-title="number">fromOffs</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="repeat-last-change-command">Repeat Last Change Command</h2>
<p>The <code>repeatLastChange</code> command runs the key sequence stored in <code>lastChange</code>
variable. Since the command inevitably causes text in the editor to change
(which causes the <code>textChanged</code> flag to go high), it has to reset the current
key sequence to prevent the <code>lastChange</code> variable from being overwritten next
time the user presses a key.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="37424" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">repeatLastChange</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="37894" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">0</span><span class="punctuation">;</span> <a href="commands.html#37894"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;</span> <a href="commands.html#5649"><span data-toggle="tooltip" data-title="string[]">lastChange</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">;</span> <a href="commands.html#37894"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="commands.html#10200"><span class="member" data-toggle="tooltip" data-title="(key: string) =&gt; Promise&lt;boolean&gt;">runActionForKey</span></a><span class="punctuation">(</span><a href="commands.html#5649"><span data-toggle="tooltip" data-title="string[]">lastChange</span></a><span class="punctuation">[</span><a href="commands.html#37894"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
    <a href="commands.html#5574"><span data-toggle="tooltip" data-title="string[]">currentKeySequence</span></a> <span class="punctuation">=</span> <a href="commands.html#5649"><span data-toggle="tooltip" data-title="string[]">lastChange</span></a>
<span class="punctuation">}</span>
</code></pre>
<h2 id="use-preset-keybindings">Use Preset Keybindings</h2>
<p>This command will overwrite to <code>keybindings</code> and <code>selectbindings</code> settings
with presets. The presets are stored under the subdirectory named <code>presets</code>.
Command scans the directory and shows all the files in a pick list.
Alternatively the user can browse for other file that he/she has anywhere
in the file system. If the user selects a file, its contents will replace
the key binding in the global <code>settings.json</code> file.</p>
<p>The presets can be defined as JSON or JavaScript. The code checks the file
extension and surrounds JSON with parenthesis. Then it can evaluate the
contents of the file as JavaScript. This allows to use non-standard JSON
files that include comments. Or, if the user likes to define the whole
shebang in code, he/she just has to make sure that the code evaluates to an
object that has <code>keybindings</code> and/or <code>selectbindings</code> properties.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="38015" class="member" data-toggle="tooltip" data-title="() =&gt; Promise&lt;void&gt;">importPresets</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">const</span> <span id="39014" data-toggle="tooltip" data-title="&quot;Browse...&quot;">browse</span> <span class="punctuation">=</span> <span class="string">&quot;Browse...&quot;</span>
    <span class="keyword">let</span> <span id="39044" data-toggle="tooltip" data-title="string">presetsPath</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.extensions">extensions</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = any&gt;(extensionId: string) =&gt; vscode.Extension&lt;T&gt; | undefined">getExtension</span><span class="punctuation">(</span><span class="string">&quot;johtela.vscode-modaledit&quot;</span><span class="punctuation">)</span><span class="punctuation">!</span>
        <span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">extensionPath</span> <span class="punctuation">+</span> <span class="string">&quot;/presets&quot;</span>
    <span class="keyword">let</span> <span id="39164" data-toggle="tooltip" data-title="vscode.FileSystem">fs</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.FileSystem">fs</span>
    <span class="keyword">let</span> <span id="39198" data-toggle="tooltip" data-title="string[]">presets</span> <span class="punctuation">=</span> <span class="punctuation">(</span><span class="keyword">await</span> <a href="commands.html#39164"><span data-toggle="tooltip" data-title="vscode.FileSystem">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(uri: vscode.Uri) =&gt; Thenable&lt;[string, vscode.FileType][]&gt;">readDirectory</span><span class="punctuation">(</span><a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Uri">Uri</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string) =&gt; vscode.Uri">file</span><span class="punctuation">(</span><a href="commands.html#39044"><span data-toggle="tooltip" data-title="string">presetsPath</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(callbackfn: (value: [string, vscode.FileType], index: number, array: [string, vscode.FileType][]) =&gt; U, thisArg?: any) =&gt; U[]">map</span><span class="punctuation">(</span><span id="39278" data-toggle="tooltip" data-title="[string, vscode.FileType]">t</span> <span class="punctuation">=&gt;</span> <a href="commands.html#39278"><span data-toggle="tooltip" data-title="[string, vscode.FileType]">t</span></a><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span><span class="punctuation">)</span>
    <a href="commands.html#39198"><span data-toggle="tooltip" data-title="string[]">presets</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><a href="commands.html#39014"><span data-toggle="tooltip" data-title="&quot;Browse...&quot;">browse</span></a><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="39323" data-toggle="tooltip" data-title="string | undefined">choice</span> <span class="punctuation">=</span> <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (items: readonly string[] | Thenable&lt;readonly string[]&gt;, options: vscode.QuickPickOptions &amp; { canPickMany: true; }, token?: vscode.CancellationToken): Thenable&lt;string[] | undefined&gt;; (items: readonly string[] | Thenable&lt;readonly string[]&gt;, options?: vscode.QuickPickOptions, token?: vscode.CancellationToken): Thena...">showQuickPick</span><span class="punctuation">(</span><a href="commands.html#39198"><span data-toggle="tooltip" data-title="string[]">presets</span></a><span class="punctuation">,</span> <span class="punctuation">{</span>
        <span id="39377" data-toggle="tooltip" data-title="string">placeHolder</span><span class="punctuation">:</span> <span class="string">&quot;Warning: Selecting a preset will override current &quot;</span> <span class="punctuation">+</span>
            <span class="string">&quot;keybindings in global &#039;settings.json&#039;&quot;</span>
    <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#39323"><span data-toggle="tooltip" data-title="string | undefined">choice</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="39547" data-toggle="tooltip" data-title="vscode.Uri">uri</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Uri">Uri</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string) =&gt; vscode.Uri">file</span><span class="punctuation">(</span><a href="commands.html#39044"><span data-toggle="tooltip" data-title="string">presetsPath</span></a> <span class="punctuation">+</span> <span class="string">&quot;/&quot;</span> <span class="punctuation">+</span> <a href="commands.html#39323"><span data-toggle="tooltip" data-title="string">choice</span></a><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#39323"><span data-toggle="tooltip" data-title="string">choice</span></a> <span class="punctuation">==</span> <a href="commands.html#39014"><span data-toggle="tooltip" data-title="&quot;Browse...&quot;">browse</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="keyword">let</span> <span id="39647" data-toggle="tooltip" data-title="vscode.Uri[] | undefined">userPreset</span> <span class="punctuation">=</span> <span class="keyword">await</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(options?: vscode.OpenDialogOptions) =&gt; Thenable&lt;vscode.Uri[] | undefined&gt;">showOpenDialog</span><span class="punctuation">(</span><span class="punctuation">{</span>
                <span id="39697" data-toggle="tooltip" data-title="string">openLabel</span><span class="punctuation">:</span> <span class="string">&quot;Import presets&quot;</span><span class="punctuation">,</span>
                <span id="39743" data-toggle="tooltip" data-title="{ JavaScript: string[]; JSON: string[]; }">filters</span><span class="punctuation">:</span> <span class="punctuation">{</span>
                    <span id="39771" data-toggle="tooltip" data-title="string[]">JavaScript</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;js&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
                    <span id="39812" data-toggle="tooltip" data-title="string[]">JSON</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;json&quot;</span><span class="punctuation">,</span> <span class="string">&quot;jsonc&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span>
                <span class="punctuation">}</span><span class="punctuation">,</span>
                <span id="39878" data-toggle="tooltip" data-title="true">canSelectFiles</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span>
                <span id="39917" data-toggle="tooltip" data-title="false">canSelectFolders</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span>
                <span id="39959" data-toggle="tooltip" data-title="false">canSelectMany</span><span class="punctuation">:</span> <span class="keyword">false</span>
            <span class="punctuation">}</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="commands.html#39647"><span data-toggle="tooltip" data-title="vscode.Uri[] | undefined">userPreset</span></a><span class="punctuation">)</span>
                <span class="keyword">return</span>
            <a href="commands.html#39547"><span data-toggle="tooltip" data-title="vscode.Uri">uri</span></a> <span class="punctuation">=</span> <a href="commands.html#39647"><span data-toggle="tooltip" data-title="vscode.Uri[]">userPreset</span></a><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span>
        <span class="punctuation">}</span>
        <span class="keyword">try</span> <span class="punctuation">{</span>
            <span class="keyword">let</span> <span id="40143" data-toggle="tooltip" data-title="string">js</span> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="commands.html#337"><span data-toggle="tooltip" data-title="typeof TextDecoder">TextDecoder</span></a><span class="punctuation">(</span><span class="string">&quot;utf-8&quot;</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(input?: NodeJS.ArrayBufferView | ArrayBuffer | null, options?: { stream?: boolean | undefined; }) =&gt; string">decode</span><span class="punctuation">(</span><span class="keyword">await</span> <a href="commands.html#39164"><span data-toggle="tooltip" data-title="vscode.FileSystem">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(uri: vscode.Uri) =&gt; Thenable&lt;Uint8Array&gt;">readFile</span><span class="punctuation">(</span><a href="commands.html#39547"><span data-toggle="tooltip" data-title="vscode.Uri">uri</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#39547"><span data-toggle="tooltip" data-title="vscode.Uri">uri</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fsPath</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (regexp: string | RegExp): RegExpMatchArray | null; (matcher: { [Symbol.match](string: string): RegExpMatchArray | null; }): RegExpMatchArray | null; }">match</span><span class="punctuation">(</span><span class="string">/jsonc?$/</span><span class="punctuation">)</span><span class="punctuation">)</span>
                <a href="commands.html#40143"><span data-toggle="tooltip" data-title="string">js</span></a> <span class="punctuation">=</span> <span class="string">`(${</span><a href="commands.html#40143"><span data-toggle="tooltip" data-title="string">js</span></a><span class="string">})`</span>
            <span class="keyword">let</span> <span id="40299" data-toggle="tooltip" data-title="any">preset</span> <span class="punctuation">=</span> <span class="member" data-toggle="tooltip" data-title="(x: string) =&gt; any">eval</span><span class="punctuation">(</span><a href="commands.html#40143"><span data-toggle="tooltip" data-title="string">js</span></a><span class="punctuation">)</span>
            <span class="keyword">let</span> <span id="40334" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span> <span class="punctuation">=</span> <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section?: string, scope?: vscode.ConfigurationScope | null) =&gt; vscode.WorkspaceConfiguration">getConfiguration</span><span class="punctuation">(</span><span class="string">&quot;modaledit&quot;</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><span class="punctuation">(</span><a href="commands.html#40299"><span data-toggle="tooltip" data-title="any">preset</span></a><span class="punctuation">.</span>keybindings <span class="punctuation">||</span> <a href="commands.html#40299"><span data-toggle="tooltip" data-title="any">preset</span></a><span class="punctuation">.</span>selectbindings<span class="punctuation">)</span><span class="punctuation">)</span>
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="typename" data-toggle="tooltip" data-title="ErrorConstructor">Error</span><span class="punctuation">(</span>
                    <span class="string">`Could not find &quot;keybindings&quot; or &quot;selectbindings&quot; in ${</span><a href="commands.html#39547"><span data-toggle="tooltip" data-title="vscode.Uri">uri</span></a><span class="string">}`</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#40299"><span data-toggle="tooltip" data-title="any">preset</span></a><span class="punctuation">.</span>keybindings<span class="punctuation">)</span>
                <a href="commands.html#40334"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section: string, value: any, configurationTarget?: vscode.ConfigurationTarget | boolean | null, overrideInLanguage?: boolean) =&gt; Thenable&lt;void&gt;">update</span><span class="punctuation">(</span><span class="string">&quot;keybindings&quot;</span><span class="punctuation">,</span> <a href="commands.html#40299"><span data-toggle="tooltip" data-title="any">preset</span></a><span class="punctuation">.</span>keybindings<span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="commands.html#40299"><span data-toggle="tooltip" data-title="any">preset</span></a><span class="punctuation">.</span>selectbindings<span class="punctuation">)</span>
                <a href="commands.html#40334"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section: string, value: any, configurationTarget?: vscode.ConfigurationTarget | boolean | null, overrideInLanguage?: boolean) =&gt; Thenable&lt;void&gt;">update</span><span class="punctuation">(</span><span class="string">&quot;selectbindings&quot;</span><span class="punctuation">,</span> <a href="commands.html#40299"><span data-toggle="tooltip" data-title="any">preset</span></a><span class="punctuation">.</span>selectbindings<span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span>
            <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showInformationMessage</span><span class="punctuation">(</span>
                <span class="string">&quot;ModalEdit: Keybindings imported.&quot;</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
        <span class="keyword">catch</span> <span class="punctuation">(</span><span id="40931" data-toggle="tooltip" data-title="unknown">e</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            <a href="commands.html#263"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showWarningMessage</span><span class="punctuation">(</span><span class="string">&quot;ModalEdit: Bindings not imported.&quot;</span><span class="punctuation">,</span>
                <span class="string">`${</span><a href="commands.html#40931"><span data-toggle="tooltip" data-title="unknown">e</span></a><span class="string">}`</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>

        </div>
            <div class="sidepane narrow-scrollbars">
                
        <div class="pagemenu">
            <h3>On This Page</h3>
                <ul class="pagetree">
                </ul>
        </div>
            </div>
        </div>
        
        <div class="footer">
            <a class="footer-button" href="actions.html">
            <p>Previous</p>
            <p>« Actions</p>
        </a>
            <div class="footer-text">
                <p>Copyright © 2025 Tommi Johtela</p>
                <p>Generated by 
                    <a href="https://johtela.github.io/litscript">LiTScript</a>
                </p>
            </div>
            <a class="footer-button" href="../CHANGELOG.html">
            <p>Next</p>
            <p>Change Log »</p>
        </a>
        </div>
    
        <script src="../dist/normal.js"></script>
    </body>
    </html>