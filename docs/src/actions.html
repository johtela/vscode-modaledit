
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>
            ModalEdit - Actions
        </title>
        <link rel="icon" type="image/icon" href="../images/favicon.svg" />
        <link rel="stylesheet" href="../dist/normal.css" />
<link rel="stylesheet" 
                    href="../dist/user-theme.css" />
        
    </head>
    <body data-syntax-highlight="monokai"
        data-theme="purple-rain">
        
        <div id="navbar">
            
    <div class="navmenu ">
        
    <div class="navitem " >
        <a class="title enabled" href="../index.html" >
            <img src="../images/escape.svg" />
            <span>ModalEdit</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://marketplace.visualstudio.com/items?itemName=johtela.vscode-modaledit" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-cloud-download" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M19 18a3.5 3.5 0 0 0 0 -7h-1a5 4.5 0 0 0 -11 -2a4.6 4.4 0 0 0 -2.1 8.4" />
            <path d="M12 13l0 9" />
            <path d="M9 19l3 3l3 -3" />
        </svg>
            <span>Download</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://github.com/johtela/vscode-modaledit" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
        </svg>
            <span>GitHub</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="../LICENSE.html" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-license" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M15 21h-9a3 3 0 0 1 -3 -3v-1h10v2a2 2 0 0 0 4 0v-14a2 2 0 1 1 2 2h-2m2 -4h-11a3 3 0 0 0 -3 3v11" />
            <path d="M9 7l4 0" />
            <path d="M9 11l4 0" />
        </svg>
            <span>License</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Syntax Highlight</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="coding-horror">
        <a   onclick="document.body.syntaxHighlight('coding-horror')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Coding Horror</span>
        </a>
        
    </div>
    <div class="navitem active" id="monokai">
        <a   onclick="document.body.syntaxHighlight('monokai')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Monokai</span>
        </a>
        
    </div>
    <div class="navitem " id="solarized-light">
        <a   onclick="document.body.syntaxHighlight('solarized-light')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Solarized Light</span>
        </a>
        
    </div>
    <div class="navitem " id="son-of-obsidian">
        <a   onclick="document.body.syntaxHighlight('son-of-obsidian')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Son of Obsidian</span>
        </a>
        
    </div>
    </div>
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Theme</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="blueberry">
        <a   onclick="document.body.theme('blueberry')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Blueberry</span>
        </a>
        
    </div>
    <div class="navitem " id="book-cover">
        <a   onclick="document.body.theme('book-cover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Book Cover</span>
        </a>
        
    </div>
    <div class="navitem " id="brownie">
        <a   onclick="document.body.theme('brownie')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Brownie</span>
        </a>
        
    </div>
    <div class="navitem " id="camouflage">
        <a   onclick="document.body.theme('camouflage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Camouflage</span>
        </a>
        
    </div>
    <div class="navitem " id="chocolate">
        <a   onclick="document.body.theme('chocolate')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Chocolate</span>
        </a>
        
    </div>
    <div class="navitem " id="greyhound">
        <a   onclick="document.body.theme('greyhound')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Greyhound</span>
        </a>
        
    </div>
    <div class="navitem " id="ice-age">
        <a   onclick="document.body.theme('ice-age')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ice Age</span>
        </a>
        
    </div>
    <div class="navitem " id="mustard">
        <a   onclick="document.body.theme('mustard')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Mustard</span>
        </a>
        
    </div>
    <div class="navitem " id="peachy">
        <a   onclick="document.body.theme('peachy')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Peachy</span>
        </a>
        
    </div>
    <div class="navitem " id="red-alert">
        <a   onclick="document.body.theme('red-alert')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Red Alert</span>
        </a>
        
    </div>
    <div class="navitem " id="ultra-violet">
        <a   onclick="document.body.theme('ultra-violet')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ultra Violet</span>
        </a>
        
    </div>
    <div class="navitem " id="vintage">
        <a   onclick="document.body.theme('vintage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Vintage</span>
        </a>
        
    </div>
    </div>
    </div>
    </div>
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        
        <div class="layout">
            <div class="sidepane narrow-scrollbars">
                
        <div class="tocmenu">
            <h3>Table of Contents</h3>
            
    <ul>
        
    <li>
        <a href="../README.html"><span>🏠</span><span data-toggle="tooltip" data-title="Home page">
            Home
        </span></a>
    </li>
    <li>
        <a href="../tutorial.html"><span>🎓</span><span data-toggle="tooltip" data-title="How to create your own keymaps">
            Tutorial
        </span></a>
    </li>
    <li>
        <a href="../presets/vim.html"><span>🦈</span><span data-toggle="tooltip" data-title="Built-in Vim presets">
            Vim Presets
        </span></a>
    </li>
    <li>
        
    <div class="accordion">
        Implementation
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="extension.html"><span>🔌</span><span data-toggle="tooltip" data-title="Main extension module">
            Extension
        </span></a>
    </li>
    <li>
        <a href="actions.html" class="highlight"><span>⌨️</span><span data-toggle="tooltip" data-title="Keymap management">
            Actions
        </span></a>
    </li>
    <li>
        <a href="commands.html"><span>📢</span><span data-toggle="tooltip" data-title="Registered commands">
            Commands
        </span></a>
    </li>
    </ul>
    </li>
    <li>
        <a href="../CHANGELOG.html"><span>📅</span><span data-toggle="tooltip" data-title="Version history">
            Change Log
        </span></a>
    </li>
    <li>
        <a href="../LICENSE.html"><span>📜</span><span data-toggle="tooltip" data-title="MIT license">
            License
        </span></a>
    </li>
    </ul>
        </div>
                <div class="toc-button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-right" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M7 7l5 5l-5 5" />
            <path d="M13 7l5 5l-5 5" />
        </svg></div>
            </div>
            
        <div class="contentarea closepopups">
            <h1 id="converting-keybinding-definitions-to-actions">Converting Keybinding Definitions to Actions</h1>
<p>This module defines the schema of the configuration file using TypeScript
interfaces. We parse the configuration JSON to TypeScript objects which
directly define all the valid keyboard sequences and the commands that these
will invoke.</p>
<details>
<summary>action.ts imports</summary>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="356" data-toggle="tooltip" data-title="typeof vscode">vscode</span> <span class="keyword">from</span> <span class="string">&#039;vscode&#039;</span>
</code></pre>
</details>
<h2 id="action-definitions">Action Definitions</h2>
<p>The keybinding configuration consist of <em>actions</em> that can take three forms:
an action can be a command (defined later), a keymap, or a number that refers
to a keymap defined earlier.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">type</span> <span id="382" class="typename" data-toggle="tooltip" data-title="Action">Action</span> <span class="punctuation">=</span> <a href="actions.html#683"><span class="typename" data-toggle="tooltip" data-title="Command">Command</span></a> <span class="punctuation">|</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a> <span class="punctuation">|</span> <span class="keyword">number</span>
</code></pre>
<p>Commands can be invoked in four ways: by specifying just command a name
(string), or using a conditional command, a command with parameters, or a
sequence (array) of commands. The definition is recursive, meaning that a
sequence can contain all four types of commands.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">type</span> <span id="683" class="typename" data-toggle="tooltip" data-title="Command">Command</span> <span class="punctuation">=</span> <span class="keyword">string</span> <span class="punctuation">|</span> <a href="actions.html#1052"><span class="typename" data-toggle="tooltip" data-title="Conditional">Conditional</span></a> <span class="punctuation">|</span> <a href="actions.html#1358"><span class="typename" data-toggle="tooltip" data-title="Parameterized">Parameterized</span></a> <span class="punctuation">|</span> <a href="actions.html#683"><span class="typename" data-toggle="tooltip" data-title="Command">Command</span></a><span class="punctuation">[</span><span class="punctuation">]</span>
</code></pre>
<p>A conditional command consist of condition (a JavaScript expression) and set
of branches to take depending on the result of the condition. Each branch can
be any type of command defined above.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">interface</span> <span id="1052" class="typename" data-toggle="tooltip" data-title="Conditional">Conditional</span> <span class="punctuation">{</span>
    <span id="1301" data-toggle="tooltip" data-title="string">condition</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span class="punctuation">[</span><span id="1331" data-toggle="tooltip" data-title="string">branch</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">]</span><span class="punctuation">:</span> <a href="actions.html#683"><span class="typename" data-toggle="tooltip" data-title="Command">Command</span></a>
<span class="punctuation">}</span>
</code></pre>
<p>A command that takes arguments can be specified using the <code>Parameterized</code>
interface. Arguments can be given either as an object or a string, which
is assumed to contain a valid JS expression. Additionally, you can specify
that the command is run multiple times by setting the <code>repeat</code> property. The
property must be either a number, or a JS expression that evaluates to a
number. If it evaluates to some other type, the expression is used as a
condition that is evaluated after the command is run. If the expression
returns a truthy value, the command is repeated.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">interface</span> <span id="1358" class="typename" data-toggle="tooltip" data-title="Parameterized">Parameterized</span> <span class="punctuation">{</span>
    <span id="2003" data-toggle="tooltip" data-title="string">command</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span id="2024" data-toggle="tooltip" data-title="string | {} | undefined">args</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span> <span class="punctuation">|</span> <span class="keyword">string</span>
    <span id="2048" data-toggle="tooltip" data-title="string | number | undefined">repeat</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">number</span> <span class="punctuation">|</span> <span class="keyword">string</span>
<span class="punctuation">}</span>
</code></pre>
<p>A keymap is a dictionary of keys (characters) to actions. Keys are either
single characters or character ranges, denoted by sequences of <code>&lt;char&gt;,&lt;char&gt;</code>
and <code>&lt;char&gt;-&lt;char&gt;</code>. Values of the dictionary can be also nested keymaps.
This is how you can define commands that require  multiple keypresses.</p>
<p><img src="../images/keymap.png" alt="keymap example">
When the value of a key is number, it refers to another keymap whose <code>id</code>
equals the number. The number can also point to the same  keymap where it
resides. With this mechanism, you can define <em>recursive</em> keymaps that can
take (theoretically) infinitely long key sequences. The picture on the right
illustrates this.</p>
<p>The <code>help</code> field contains help text that is shown in the status bar when the
keymap is active.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">interface</span> <span id="2081" class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span> <span class="punctuation">{</span>
    <span id="2933" data-toggle="tooltip" data-title="number">id</span><span class="punctuation">:</span> <span class="keyword">number</span>
    <span id="2949" data-toggle="tooltip" data-title="string">help</span><span class="punctuation">:</span> <span class="keyword">string</span>
    <span class="punctuation">[</span><span id="2974" data-toggle="tooltip" data-title="string">key</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">]</span><span class="punctuation">:</span> <a href="actions.html#382"><span class="typename" data-toggle="tooltip" data-title="Action">Action</span></a>
<span class="punctuation">}</span>
</code></pre>
<h2 id="cursor-shapes">Cursor Shapes</h2>
<p>You can use various cursor shapes in different modes. The list of available
shapes is defined below.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">type</span> <span id="2997" class="typename" data-toggle="tooltip" data-title="Cursor">Cursor</span> <span class="punctuation">=</span>
    <span class="punctuation">|</span> <span class="string">&quot;block&quot;</span>
    <span class="punctuation">|</span> <span class="string">&quot;block-outline&quot;</span>
    <span class="punctuation">|</span> <span class="string">&quot;line&quot;</span>
    <span class="punctuation">|</span> <span class="string">&quot;line-thin&quot;</span>
    <span class="punctuation">|</span> <span class="string">&quot;underline&quot;</span>
    <span class="punctuation">|</span> <span class="string">&quot;underline-thin&quot;</span>
    <span class="punctuation">|</span> <span class="keyword">undefined</span>
</code></pre>
<h2 id="configuration-state">Configuration State</h2>
<p>The variables below contain the current cursor configuration.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="3400" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">insertCursorStyle</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span>
<span class="keyword">let</span> <span id="3453" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">normalCursorStyle</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span>
<span class="keyword">let</span> <span id="3506" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">searchCursorStyle</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span>
<span class="keyword">let</span> <span id="3559" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">selectCursorStyle</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span>
<span class="keyword">let</span> <span id="3612" data-toggle="tooltip" data-title="string">insertStatusText</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="keyword">let</span> <span id="3642" data-toggle="tooltip" data-title="string">normalStatusText</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="keyword">let</span> <span id="3672" data-toggle="tooltip" data-title="string">searchStatusText</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="keyword">let</span> <span id="3702" data-toggle="tooltip" data-title="string">selectStatusText</span><span class="punctuation">:</span> <span class="keyword">string</span>
<span class="keyword">let</span> <span id="3732" data-toggle="tooltip" data-title="string | undefined">insertStatusColor</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="3775" data-toggle="tooltip" data-title="string | undefined">normalStatusColor</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="3818" data-toggle="tooltip" data-title="string | undefined">searchStatusColor</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
<span class="keyword">let</span> <span id="3861" data-toggle="tooltip" data-title="string | undefined">selectStatusColor</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span>
</code></pre>
<p>Another thing you can set in config, is whether ModalEdit starts in normal
mode.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4004" data-toggle="tooltip" data-title="boolean">startInNormalMode</span><span class="punctuation">:</span> <span class="keyword">boolean</span>
</code></pre>
<p>The root of the action configuration is keymap. This defines what key
sequences will be run when keys are pressed in normal mode.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4185" data-toggle="tooltip" data-title="Keymap">baseKeymap</span><span class="punctuation">:</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a>
<span class="keyword">let</span> <span id="4209" data-toggle="tooltip" data-title="Keymap">selectKeymap</span><span class="punctuation">:</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a>
</code></pre>
<p>The current active keymap is stored here. The active keymap changes when the
user invokes a multi-key action sequence.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4372" data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span><span class="punctuation">:</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a> <span class="punctuation">|</span> <span class="keyword">null</span> <span class="punctuation">=</span> <span class="keyword">null</span>
</code></pre>
<p>The last command run is also stored. This is needed to run commands which
capture the keyboard.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4527" data-toggle="tooltip" data-title="string">lastCommand</span><span class="punctuation">:</span> <span class="keyword">string</span>
</code></pre>
<p>The key sequence that user has pressed is stored for error reporting
purposes and to make it available to command arguments. Since commands
can invoke other commands through <code>typeNormalKeys</code> command, we need to
maintain the key sequences in a stack. Both current key sequence and the
stack is initialized to empty array.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="4904" data-toggle="tooltip" data-title="string[]">keySequence</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
<span class="keyword">let</span> <span id="4936" data-toggle="tooltip" data-title="string[][]">keySeqStack</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
</code></pre>
<p>We need a dictionary that returns a keymap for given id.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="5041" data-toggle="tooltip" data-title="{ [id: number]: Keymap; }">keymapsById</span><span class="punctuation">:</span> <span class="punctuation">{</span> <span class="punctuation">[</span><span id="5058" data-toggle="tooltip" data-title="number">id</span><span class="punctuation">:</span> <span class="keyword">number</span><span class="punctuation">]</span><span class="punctuation">:</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a> <span class="punctuation">}</span>
</code></pre>
<h2 id="configuration-accessors">Configuration Accessors</h2>
<p>The following functions return the current configuration settings.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="5079" class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getInsertStyles</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> 
    <span class="punctuation">[</span><a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">,</span> <span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="punctuation">[</span> <a href="actions.html#3400"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">insertCursorStyle</span></a><span class="punctuation">,</span> <a href="actions.html#3612"><span data-toggle="tooltip" data-title="string">insertStatusText</span></a><span class="punctuation">,</span> <a href="actions.html#3732"><span data-toggle="tooltip" data-title="string | undefined">insertStatusColor</span></a> <span class="punctuation">]</span>
<span class="punctuation">}</span>

<span class="keyword">export</span> <span class="keyword">function</span> <span id="5373" class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getNormalStyles</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> 
    <span class="punctuation">[</span><a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">,</span> <span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span> <span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="punctuation">[</span> <a href="actions.html#3453"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">normalCursorStyle</span></a><span class="punctuation">,</span> <a href="actions.html#3642"><span data-toggle="tooltip" data-title="string">normalStatusText</span></a><span class="punctuation">,</span> <a href="actions.html#3775"><span data-toggle="tooltip" data-title="string | undefined">normalStatusColor</span></a> <span class="punctuation">]</span>
<span class="punctuation">}</span>

<span class="keyword">export</span> <span class="keyword">function</span> <span id="5553" class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getSearchStyles</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> 
    <span class="punctuation">[</span><a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">,</span> <span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">string</span>  <span class="punctuation">|</span> <span class="keyword">undefined</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="punctuation">[</span> <a href="actions.html#3506"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">searchCursorStyle</span></a><span class="punctuation">,</span> <a href="actions.html#3672"><span data-toggle="tooltip" data-title="string">searchStatusText</span></a><span class="punctuation">,</span> <a href="actions.html#3818"><span data-toggle="tooltip" data-title="string | undefined">searchStatusColor</span></a> <span class="punctuation">]</span>
<span class="punctuation">}</span>

<span class="keyword">export</span> <span class="keyword">function</span> <span id="5733" class="member" data-toggle="tooltip" data-title="() =&gt; [vscode.TextEditorCursorStyle, string, string | undefined]">getSelectStyles</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> 
    <span class="punctuation">[</span><a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">,</span> <span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="punctuation">[</span> <a href="actions.html#3559"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">selectCursorStyle</span></a><span class="punctuation">,</span> <a href="actions.html#3702"><span data-toggle="tooltip" data-title="string">selectStatusText</span></a><span class="punctuation">,</span> <a href="actions.html#3861"><span data-toggle="tooltip" data-title="string | undefined">selectStatusColor</span></a> <span class="punctuation">]</span>
<span class="punctuation">}</span>

<span class="keyword">export</span> <span class="keyword">function</span> <span id="5912" class="member" data-toggle="tooltip" data-title="() =&gt; boolean">getStartInNormalMode</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">boolean</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#4004"><span data-toggle="tooltip" data-title="boolean">startInNormalMode</span></a>
<span class="punctuation">}</span>
</code></pre>
<p>You can also set the last command from outside the module.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="5998" class="member" data-toggle="tooltip" data-title="(command: string) =&gt; void">setLastCommand</span><span class="punctuation">(</span><span id="6104" data-toggle="tooltip" data-title="string">command</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="actions.html#4527"><span data-toggle="tooltip" data-title="string">lastCommand</span></a> <span class="punctuation">=</span> <a href="actions.html#6104"><span data-toggle="tooltip" data-title="string">command</span></a>
<span class="punctuation">}</span>
</code></pre>
<h2 id="logging">Logging</h2>
<p>To enable logging and error reporting ModalEdit creates an output channel
that is visible in the output pane. The channel is created in the extension
activation hook, but it is passed to this module using the <code>setOutputChannel</code>
function.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="6441" data-toggle="tooltip" data-title="vscode.OutputChannel">outputChannel</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.OutputChannel">OutputChannel</span>

<span class="keyword">export</span> <span class="keyword">function</span> <span id="6477" class="member" data-toggle="tooltip" data-title="(channel: vscode.OutputChannel) =&gt; void">setOutputChannel</span><span class="punctuation">(</span><span id="6514" data-toggle="tooltip" data-title="vscode.OutputChannel">channel</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.OutputChannel">OutputChannel</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="actions.html#6441"><span data-toggle="tooltip" data-title="vscode.OutputChannel">outputChannel</span></a> <span class="punctuation">=</span> <a href="actions.html#6514"><span data-toggle="tooltip" data-title="vscode.OutputChannel">channel</span></a>
<span class="punctuation">}</span>
</code></pre>
<p>Once the channel is set, we can output messages to it using the <code>log</code>
function.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="6578" class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">log</span><span class="punctuation">(</span><span id="6699" data-toggle="tooltip" data-title="string">message</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="actions.html#6441"><span data-toggle="tooltip" data-title="vscode.OutputChannel">outputChannel</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(value: string) =&gt; void">appendLine</span><span class="punctuation">(</span><a href="actions.html#6699"><span data-toggle="tooltip" data-title="string">message</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="updating-configuration-from-settings-json">Updating Configuration from settings.json</h2>
<p>Whenever you save the user-level <code>settings.json</code> or the one located in the
<code>.vsode</code> directory VS Code calls this function that updates the current
configuration.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="6759" class="member" data-toggle="tooltip" data-title="() =&gt; void">updateFromConfig</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span> <span class="punctuation">{</span>
    <span class="keyword">const</span> <span id="7054" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span> <span class="punctuation">=</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.workspace">workspace</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(section?: string, scope?: vscode.ConfigurationScope | null) =&gt; vscode.WorkspaceConfiguration">getConfiguration</span><span class="punctuation">(</span><span class="string">&quot;modaledit&quot;</span><span class="punctuation">)</span>
    <a href="actions.html#8223"><span class="member" data-toggle="tooltip" data-title="(config: vscode.WorkspaceConfiguration) =&gt; void">UpdateKeybindings</span></a><span class="punctuation">(</span><a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">)</span>
    <a href="actions.html#3400"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">insertCursorStyle</span></a> <span class="punctuation">=</span> <a href="actions.html#11555"><span class="member" data-toggle="tooltip" data-title="(cursor: Cursor) =&gt; vscode.TextEditorCursorStyle">toVSCursorStyle</span></a><span class="punctuation">(</span>
        <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><a href="actions.html#2997"><span class="typename" data-toggle="tooltip" data-title="Cursor">Cursor</span></a><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;insertCursorStyle&quot;</span><span class="punctuation">,</span> <span class="string">&quot;line&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>
    <a href="actions.html#3453"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">normalCursorStyle</span></a> <span class="punctuation">=</span> <a href="actions.html#11555"><span class="member" data-toggle="tooltip" data-title="(cursor: Cursor) =&gt; vscode.TextEditorCursorStyle">toVSCursorStyle</span></a><span class="punctuation">(</span>
        <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><a href="actions.html#2997"><span class="typename" data-toggle="tooltip" data-title="Cursor">Cursor</span></a><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;normalCursorStyle&quot;</span><span class="punctuation">,</span> <span class="string">&quot;block&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>
    <a href="actions.html#3506"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">searchCursorStyle</span></a> <span class="punctuation">=</span> <a href="actions.html#11555"><span class="member" data-toggle="tooltip" data-title="(cursor: Cursor) =&gt; vscode.TextEditorCursorStyle">toVSCursorStyle</span></a><span class="punctuation">(</span>
        <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><a href="actions.html#2997"><span class="typename" data-toggle="tooltip" data-title="Cursor">Cursor</span></a><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;searchCursorStyle&quot;</span><span class="punctuation">,</span> <span class="string">&quot;underline&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>
    <a href="actions.html#3559"><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">selectCursorStyle</span></a> <span class="punctuation">=</span> <a href="actions.html#11555"><span class="member" data-toggle="tooltip" data-title="(cursor: Cursor) =&gt; vscode.TextEditorCursorStyle">toVSCursorStyle</span></a><span class="punctuation">(</span>
        <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><a href="actions.html#2997"><span class="typename" data-toggle="tooltip" data-title="Cursor">Cursor</span></a><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;selectCursorStyle&quot;</span><span class="punctuation">,</span> <span class="string">&quot;line-thin&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>
    <a href="actions.html#3612"><span data-toggle="tooltip" data-title="string">insertStatusText</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;insertStatusText&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-- $(edit) INSERT --&quot;</span><span class="punctuation">)</span>
    <a href="actions.html#3642"><span data-toggle="tooltip" data-title="string">normalStatusText</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;normalStatusText&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-- $(move) NORMAL --&quot;</span><span class="punctuation">)</span>
    <a href="actions.html#3672"><span data-toggle="tooltip" data-title="string">searchStatusText</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;searchStatusText&quot;</span><span class="punctuation">,</span> <span class="string">&quot;$(search) SEARCH&quot;</span><span class="punctuation">)</span>
    <a href="actions.html#3702"><span data-toggle="tooltip" data-title="string">selectStatusText</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;selectStatusText&quot;</span><span class="punctuation">,</span> <span class="string">&quot;-- $(paintcan) VISUAL --&quot;</span><span class="punctuation">)</span>
    <a href="actions.html#3732"><span data-toggle="tooltip" data-title="string | undefined">insertStatusColor</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;insertStatusColor&quot;</span><span class="punctuation">)</span> <span class="punctuation">||</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <a href="actions.html#3775"><span data-toggle="tooltip" data-title="string | undefined">normalStatusColor</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;normalStatusColor&quot;</span><span class="punctuation">)</span> <span class="punctuation">||</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <a href="actions.html#3818"><span data-toggle="tooltip" data-title="string | undefined">searchStatusColor</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;searchStatusColor&quot;</span><span class="punctuation">)</span> <span class="punctuation">||</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <a href="actions.html#3861"><span data-toggle="tooltip" data-title="string | undefined">selectStatusColor</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">(</span><span class="string">&quot;selectStatusColor&quot;</span><span class="punctuation">)</span> <span class="punctuation">||</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <a href="actions.html#4004"><span data-toggle="tooltip" data-title="boolean">startInNormalMode</span></a> <span class="punctuation">=</span> <a href="actions.html#7054"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><span class="keyword">boolean</span><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;startInNormalMode&quot;</span><span class="punctuation">,</span> <span class="keyword">true</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>The following function updates base keymap and select-mode keymap.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="8223" class="member" data-toggle="tooltip" data-title="(config: vscode.WorkspaceConfiguration) =&gt; void">UpdateKeybindings</span><span class="punctuation">(</span><span id="8333" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">WorkspaceConfiguration</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="actions.html#6578"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&quot;Validating keybindings in &#039;settings.json&#039;...&quot;</span><span class="punctuation">)</span>
    <a href="actions.html#5041"><span data-toggle="tooltip" data-title="{ [id: number]: Keymap; }">keymapsById</span></a> <span class="punctuation">=</span> <span class="punctuation">{</span><span class="punctuation">}</span>
    <a href="actions.html#9299"><span data-toggle="tooltip" data-title="number">errors</span></a> <span class="punctuation">=</span> <span class="number">0</span>
    <span class="keyword">let</span> <span id="8477" data-toggle="tooltip" data-title="object | undefined">sel</span> <span class="punctuation">=</span> <a href="actions.html#8333"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><span class="keyword">object</span><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;selectbindings&quot;</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#14005"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Keymap">isKeymap</span></a><span class="punctuation">(</span><a href="actions.html#8477"><span data-toggle="tooltip" data-title="object | undefined">sel</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#4209"><span data-toggle="tooltip" data-title="Keymap">selectKeymap</span></a> <span class="punctuation">=</span> <a href="actions.html#8477"><span data-toggle="tooltip" data-title="Keymap">sel</span></a>
        <a href="actions.html#9723"><span class="member" data-toggle="tooltip" data-title="(keybindings: Keymap) =&gt; void">validateAndResolveKeymaps</span></a><span class="punctuation">(</span><a href="actions.html#8477"><span data-toggle="tooltip" data-title="Keymap">sel</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">let</span> <span id="8630" data-toggle="tooltip" data-title="object | undefined">base</span> <span class="punctuation">=</span> <a href="actions.html#8333"><span data-toggle="tooltip" data-title="vscode.WorkspaceConfiguration">config</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(section: string): T | undefined; &lt;T&gt;(section: string, defaultValue: T): T; }">get</span><span class="punctuation">&lt;</span><span class="keyword">object</span><span class="punctuation">&gt;</span><span class="punctuation">(</span><span class="string">&quot;keybindings&quot;</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#14005"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Keymap">isKeymap</span></a><span class="punctuation">(</span><a href="actions.html#8630"><span data-toggle="tooltip" data-title="object | undefined">base</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#4185"><span data-toggle="tooltip" data-title="Keymap">baseKeymap</span></a> <span class="punctuation">=</span> <a href="actions.html#8630"><span data-toggle="tooltip" data-title="Keymap">base</span></a>
        <a href="actions.html#9723"><span class="member" data-toggle="tooltip" data-title="(keybindings: Keymap) =&gt; void">validateAndResolveKeymaps</span></a><span class="punctuation">(</span><a href="actions.html#8630"><span data-toggle="tooltip" data-title="Keymap">base</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">else</span>
        <a href="actions.html#6578"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&quot;ERROR: Invalid configuration structure. Keybindings not updated.&quot;</span><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#9299"><span data-toggle="tooltip" data-title="number">errors</span></a> <span class="punctuation">&gt;</span> <span class="number">0</span><span class="punctuation">)</span>
        <a href="actions.html#6578"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">`Found ${</span><a href="actions.html#9299"><span data-toggle="tooltip" data-title="number">errors</span></a><span class="string">} error${</span><a href="actions.html#9299"><span data-toggle="tooltip" data-title="number">errors</span></a> <span class="punctuation">&gt;</span> <span class="number">1</span> <span class="punctuation">?</span> <span class="string">&quot;s&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="string">}. `</span> <span class="punctuation">+</span>
            <span class="string">&quot;Keybindings might not work correctly.&quot;</span><span class="punctuation">)</span>
    <span class="keyword">else</span>
        <a href="actions.html#6578"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&quot;Validation completed successfully.&quot;</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>To make sure that the keybinding section is valid, we define a function that
checks it. At the same time the function resolves all the keymaps that are
referred by an id. It records the number of errors.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="9299" data-toggle="tooltip" data-title="number">errors</span><span class="punctuation">:</span> <span class="keyword">number</span>
</code></pre>
<p>The keymap ranges are recognized with the following regular expression.
Examples of valid key sequences include:</p>
<ul>
<li><code>0-9</code></li>
<li><code>a,b,c</code></li>
<li><code>d,e-h,l</code></li>
</ul>
<p>Basically you can add individual characters to the range with a comma <code>,</code> and
an ASCII range with dash <code>-</code>. The ASCII code of the first character must be
smaller than the second one's.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="9700" data-toggle="tooltip" data-title="RegExp">keyRE</span> <span class="punctuation">=</span> <span class="string">/^.([\-,].)+$/</span>
</code></pre>
<p>The function itself is recursive; it calls itself, if it finds a nested
keymap. It stores all the keymaps it encounters in the <code>keymapsById</code>
dictionary.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="9723" class="member" data-toggle="tooltip" data-title="(keybindings: Keymap) =&gt; void">validateAndResolveKeymaps</span><span class="punctuation">(</span><span id="9936" data-toggle="tooltip" data-title="Keymap">keybindings</span><span class="punctuation">:</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">function</span> <span id="9958" class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">error</span><span class="punctuation">(</span><span id="9979" data-toggle="tooltip" data-title="string">message</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#6578"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">log</span></a><span class="punctuation">(</span><span class="string">&quot;ERROR: &quot;</span> <span class="punctuation">+</span> <a href="actions.html#9979"><span data-toggle="tooltip" data-title="string">message</span></a><span class="punctuation">)</span>
        <a href="actions.html#9299"><span data-toggle="tooltip" data-title="number">errors</span></a><span class="punctuation">++</span>
    <span class="punctuation">}</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">.</span><a href="actions.html#2933"><span data-toggle="tooltip" data-title="number">id</span></a> <span class="punctuation">===</span> <span class="string">&#039;number&#039;</span><span class="punctuation">)</span>
        <a href="actions.html#5041"><span data-toggle="tooltip" data-title="{ [id: number]: Keymap; }">keymapsById</span></a><span class="punctuation">[</span><a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">.</span><a href="actions.html#2933"><span data-toggle="tooltip" data-title="number">id</span></a><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="10166" data-toggle="tooltip" data-title="string">key</span> <span class="keyword">in</span> <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(v: PropertyKey) =&gt; boolean">hasOwnProperty</span><span class="punctuation">(</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a> <span class="punctuation">!=</span> <span class="string">&quot;id&quot;</span> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a> <span class="punctuation">!=</span> <span class="string">&quot;help&quot;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="keyword">let</span> <span id="10285" data-toggle="tooltip" data-title="Action">target</span> <span class="punctuation">=</span> <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">[</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#14005"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Keymap">isKeymap</span></a><span class="punctuation">(</span><a href="actions.html#10285"><span data-toggle="tooltip" data-title="Action">target</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
                <a href="actions.html#9723"><span class="member" data-toggle="tooltip" data-title="(keybindings: Keymap) =&gt; void">validateAndResolveKeymaps</span></a><span class="punctuation">(</span><a href="actions.html#10285"><span data-toggle="tooltip" data-title="Keymap">target</span></a><span class="punctuation">)</span>
            <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="actions.html#10285"><span data-toggle="tooltip" data-title="number | Command">target</span></a> <span class="punctuation">===</span> <span class="string">&#039;number&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">let</span> <span id="10470" data-toggle="tooltip" data-title="number">id</span> <span class="punctuation">=</span> <a href="actions.html#10285"><span data-toggle="tooltip" data-title="number">target</span></a>
                <a href="actions.html#10285"><span data-toggle="tooltip" data-title="Action">target</span></a> <span class="punctuation">=</span> <a href="actions.html#5041"><span data-toggle="tooltip" data-title="{ [id: number]: Keymap; }">keymapsById</span></a><span class="punctuation">[</span><a href="actions.html#10470"><span data-toggle="tooltip" data-title="number">id</span></a><span class="punctuation">]</span>
                <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="actions.html#10285"><span data-toggle="tooltip" data-title="Keymap">target</span></a><span class="punctuation">)</span>
                    <a href="actions.html#9958"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">`Undefined keymap id: ${</span><a href="actions.html#10470"><span data-toggle="tooltip" data-title="number">id</span></a><span class="string">}`</span><span class="punctuation">)</span>
                <span class="keyword">else</span>
                    <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">[</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="actions.html#10285"><span data-toggle="tooltip" data-title="Keymap">target</span></a>
            <span class="punctuation">}</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (regexp: string | RegExp): RegExpMatchArray | null; (matcher: { [Symbol.match](string: string): RegExpMatchArray | null; }): RegExpMatchArray | null; }">match</span><span class="punctuation">(</span><a href="actions.html#9700"><span data-toggle="tooltip" data-title="RegExp">keyRE</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
                <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="10756" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">1</span><span class="punctuation">;</span> <a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;</span> <a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">;</span> <a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">+=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">[</span><a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span> <span class="punctuation">==</span> <span class="string">&#039;-&#039;</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                        <span class="keyword">let</span> <span id="10860" data-toggle="tooltip" data-title="number">first</span> <span class="punctuation">=</span> <a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(index: number) =&gt; number">charCodeAt</span><span class="punctuation">(</span><a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">-</span> <span class="number">1</span><span class="punctuation">)</span>
                        <span class="keyword">let</span> <span id="10919" data-toggle="tooltip" data-title="number">last</span> <span class="punctuation">=</span> <a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(index: number) =&gt; number">charCodeAt</span><span class="punctuation">(</span><a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">+</span> <span class="number">1</span><span class="punctuation">)</span>
                        <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#10860"><span data-toggle="tooltip" data-title="number">first</span></a> <span class="punctuation">&gt;</span> <a href="actions.html#10919"><span data-toggle="tooltip" data-title="number">last</span></a><span class="punctuation">)</span>
                            <a href="actions.html#9958"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">`Invalid key range: &quot;${</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="string">}&quot;`</span><span class="punctuation">)</span>
                        <span class="keyword">else</span>
                            <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="11125" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <a href="actions.html#10860"><span data-toggle="tooltip" data-title="number">first</span></a><span class="punctuation">;</span> <a href="actions.html#11125"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;=</span> <a href="actions.html#10919"><span data-toggle="tooltip" data-title="number">last</span></a><span class="punctuation">;</span> <a href="actions.html#11125"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span><span class="punctuation">)</span>
                                <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">[</span><span class="typename" data-toggle="tooltip" data-title="StringConstructor">String</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...codes: number[]) =&gt; string">fromCharCode</span><span class="punctuation">(</span><a href="actions.html#11125"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">)</span><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="actions.html#10285"><span data-toggle="tooltip" data-title="Command | Keymap">target</span></a>
                    <span class="punctuation">}</span>
                    <span class="keyword">else</span> <span class="punctuation">{</span>
                        <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">[</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">[</span><a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">-</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="actions.html#10285"><span data-toggle="tooltip" data-title="Command | Keymap">target</span></a>
                        <a href="actions.html#9936"><span data-toggle="tooltip" data-title="Keymap">keybindings</span></a><span class="punctuation">[</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">[</span><a href="actions.html#10756"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">+</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="actions.html#10285"><span data-toggle="tooltip" data-title="Command | Keymap">target</span></a>
                    <span class="punctuation">}</span>
                <span class="punctuation">}</span>
            <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">!=</span> <span class="number">1</span><span class="punctuation">)</span>
                <a href="actions.html#9958"><span class="member" data-toggle="tooltip" data-title="(message: string) =&gt; void">error</span></a><span class="punctuation">(</span><span class="string">`Invalid key binding: &quot;${</span><a href="actions.html#10166"><span data-toggle="tooltip" data-title="string">key</span></a><span class="string">}&quot;`</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>The helper function below converts cursor styles specified in configuration
to enumeration members used by VS Code.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="11555" class="member" data-toggle="tooltip" data-title="(cursor: Cursor) =&gt; vscode.TextEditorCursorStyle">toVSCursorStyle</span><span class="punctuation">(</span><span id="11717" data-toggle="tooltip" data-title="Cursor">cursor</span><span class="punctuation">:</span> <a href="actions.html#2997"><span class="typename" data-toggle="tooltip" data-title="Cursor">Cursor</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="any">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle">TextEditorCursorStyle</span> <span class="punctuation">{</span>
    <span class="keyword">switch</span> <span class="punctuation">(</span><a href="actions.html#11717"><span data-toggle="tooltip" data-title="Cursor">cursor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">case</span> <span class="string">&quot;line&quot;</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Line">Line</span>
        <span class="keyword">case</span> <span class="string">&quot;block&quot;</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Block">Block</span>
        <span class="keyword">case</span> <span class="string">&quot;underline&quot;</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Underline">Underline</span>
        <span class="keyword">case</span> <span class="string">&quot;line-thin&quot;</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.LineThin">LineThin</span>
        <span class="keyword">case</span> <span class="string">&quot;block-outline&quot;</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.BlockOutline">BlockOutline</span>
        <span class="keyword">case</span> <span class="string">&quot;underline-thin&quot;</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.UnderlineThin">UnderlineThin</span>
        <span class="keyword">default</span><span class="punctuation">:</span> <span class="keyword">return</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.TextEditorCursorStyle">TextEditorCursorStyle</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditorCursorStyle.Line">Line</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="type-predicates">Type Predicates</h2>
<p>Since JavaScript does not have dynamic type information we need to write
functions that check which type of action we get from the configuration.
First we define a high-level type predicate that checks if a value is
an action.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="12291" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isAction</span><span class="punctuation">(</span><span id="12593" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#12593"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <a href="actions.html#382"><span class="typename" data-toggle="tooltip" data-title="Action">Action</span></a> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#13084"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isCommand</span></a><span class="punctuation">(</span><a href="actions.html#12593"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">||</span> <a href="actions.html#14005"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Keymap">isKeymap</span></a><span class="punctuation">(</span><a href="actions.html#12593"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">||</span> <a href="actions.html#12816"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is number">isNumber</span></a><span class="punctuation">(</span><a href="actions.html#12593"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>This one checks whether a value is a string.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="12673" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span><span class="punctuation">(</span><span id="12752" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#12752"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <span class="keyword">string</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#12752"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="punctuation">&amp;&amp;</span> <span class="keyword">typeof</span> <a href="actions.html#12752"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="punctuation">===</span> <span class="string">&quot;string&quot;</span>
<span class="punctuation">}</span>
</code></pre>
<p>This one checks whether a value is a number.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="12816" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is number">isNumber</span><span class="punctuation">(</span><span id="12895" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#12895"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <span class="keyword">number</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#12895"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="punctuation">&amp;&amp;</span> <span class="keyword">typeof</span> <a href="actions.html#12895"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="punctuation">===</span> <span class="string">&quot;number&quot;</span>
<span class="punctuation">}</span>
</code></pre>
<p>This one identifies an object.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="12959" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; boolean">isObject</span><span class="punctuation">(</span><span id="13024" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">boolean</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#13024"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="punctuation">&amp;&amp;</span> <span class="keyword">typeof</span> <a href="actions.html#13024"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="punctuation">===</span> <span class="string">&quot;object&quot;</span>
<span class="punctuation">}</span>
</code></pre>
<p>This checks if a value is a command.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="13084" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isCommand</span><span class="punctuation">(</span><span id="13156" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#13156"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <a href="actions.html#382"><span class="typename" data-toggle="tooltip" data-title="Action">Action</span></a> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#13156"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">||</span> <a href="actions.html#13701"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Parameterized">isParameterized</span></a><span class="punctuation">(</span><a href="actions.html#13156"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">||</span> <a href="actions.html#13450"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Conditional">isConditional</span></a><span class="punctuation">(</span><a href="actions.html#13156"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">||</span>
        <a href="actions.html#13280"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Command[]">isCommandSequence</span></a><span class="punctuation">(</span><a href="actions.html#13156"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>This checks if a value is an array of commands.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="13280" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Command[]">isCommandSequence</span><span class="punctuation">(</span><span id="13371" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#13371"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <a href="actions.html#683"><span class="typename" data-toggle="tooltip" data-title="Command">Command</span></a><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="typename" data-toggle="tooltip" data-title="ArrayConstructor">Array</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(arg: any) =&gt; arg is any[]">isArray</span><span class="punctuation">(</span><a href="actions.html#13371"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#13371"><span data-toggle="tooltip" data-title="any[]">x</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;S extends any&gt;(predicate: (value: any, index: number, array: any[]) =&gt; value is S, thisArg?: any): this is S[]; (predicate: (value: any, index: number, array: any[]) =&gt; unknown, thisArg?: any): boolean; }">every</span><span class="punctuation">(</span><a href="actions.html#13084"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isCommand</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>This recognizes a conditional action.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="13450" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Conditional">isConditional</span><span class="punctuation">(</span><span id="13527" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#13527"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <a href="actions.html#1052"><span class="typename" data-toggle="tooltip" data-title="Conditional">Conditional</span></a> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#12959"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; boolean">isObject</span></a><span class="punctuation">(</span><a href="actions.html#13527"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#13527"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>condition<span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span>
        <span class="typename" data-toggle="tooltip" data-title="ObjectConstructor">Object</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (o: object): string[]; (o: {}): string[]; }">keys</span><span class="punctuation">(</span><a href="actions.html#13527"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;S extends string&gt;(predicate: (value: string, index: number, array: string[]) =&gt; value is S, thisArg?: any): this is S[]; (predicate: (value: string, index: number, array: string[]) =&gt; unknown, thisArg?: any): boolean; }">every</span><span class="punctuation">(</span><span id="13637" data-toggle="tooltip" data-title="string">key</span> <span class="punctuation">=&gt;</span>
            <a href="actions.html#13637"><span data-toggle="tooltip" data-title="string">key</span></a> <span class="punctuation">===</span> <span class="string">&quot;condition&quot;</span> <span class="punctuation">||</span> <a href="actions.html#13084"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isCommand</span></a><span class="punctuation">(</span><a href="actions.html#13527"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">[</span><a href="actions.html#13637"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>This asserts that a value is a parameterized command.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="13701" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Parameterized">isParameterized</span><span class="punctuation">(</span><span id="13796" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <a href="actions.html#1358"><span class="typename" data-toggle="tooltip" data-title="Parameterized">Parameterized</span></a> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#12959"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; boolean">isObject</span></a><span class="punctuation">(</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>command<span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span>
        <span class="punctuation">(</span><span class="punctuation">!</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>args <span class="punctuation">||</span> <a href="actions.html#12959"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; boolean">isObject</span></a><span class="punctuation">(</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>args<span class="punctuation">)</span> <span class="punctuation">||</span> <a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>args<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span>
        <span class="punctuation">(</span><span class="punctuation">!</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>repeat <span class="punctuation">||</span> <a href="actions.html#12816"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is number">isNumber</span></a><span class="punctuation">(</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>repeat<span class="punctuation">)</span> <span class="punctuation">||</span> <a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#13796"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">.</span>repeat<span class="punctuation">)</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>And finally this one checks if a value is a keymap.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="14005" class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Keymap">isKeymap</span><span class="punctuation">(</span><span id="14091" data-toggle="tooltip" data-title="any">x</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span><span class="punctuation">:</span> <a href="actions.html#14091"><span data-toggle="tooltip" data-title="any">x</span></a> <span class="keyword">is</span> <a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#12959"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; boolean">isObject</span></a><span class="punctuation">(</span><a href="actions.html#14091"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <span class="punctuation">!</span><a href="actions.html#13450"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Conditional">isConditional</span></a><span class="punctuation">(</span><a href="actions.html#14091"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span> <span class="punctuation">!</span><a href="actions.html#13701"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Parameterized">isParameterized</span></a><span class="punctuation">(</span><a href="actions.html#14091"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span>
        <span class="typename" data-toggle="tooltip" data-title="ObjectConstructor">Object</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(o: { [s: string]: T; } | ArrayLike&lt;T&gt;): T[]; (o: {}): any[]; }">values</span><span class="punctuation">(</span><a href="actions.html#14091"><span data-toggle="tooltip" data-title="any">x</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;S extends unknown&gt;(predicate: (value: unknown, index: number, array: unknown[]) =&gt; value is S, thisArg?: any): this is S[]; (predicate: (value: unknown, index: number, array: unknown[]) =&gt; unknown, thisArg?: any): boolean; }">every</span><span class="punctuation">(</span><a href="actions.html#12291"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isAction</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="executing-commands">Executing Commands</h2>
<p>In the end all keybindings will invoke one or more VS Code commands. The
following function runs a command whose name and arguments are given as
parameters. If the command throws an exception because of invalid arguments,
for example, the error is shown in the popup window at the corner of the
screen.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="14229" class="member" data-toggle="tooltip" data-title="(command: string, ...rest: any[]) =&gt; Promise&lt;void&gt;">executeVSCommand</span><span class="punctuation">(</span><span id="14628" data-toggle="tooltip" data-title="string">command</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span> <span class="punctuation">...</span><span id="14644" data-toggle="tooltip" data-title="any[]">rest</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">try</span> <span class="punctuation">{</span>
        <span class="keyword">await</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.commands">commands</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;T = unknown&gt;(command: string, ...rest: any[]) =&gt; Thenable&lt;T&gt;">executeCommand</span><span class="punctuation">(</span><a href="actions.html#14628"><span data-toggle="tooltip" data-title="string">command</span></a><span class="punctuation">,</span> <span class="punctuation">...</span><a href="actions.html#14644"><span data-toggle="tooltip" data-title="any[]">rest</span></a><span class="punctuation">)</span>
        <a href="actions.html#4527"><span data-toggle="tooltip" data-title="string">lastCommand</span></a> <span class="punctuation">=</span> <a href="actions.html#14628"><span data-toggle="tooltip" data-title="string">command</span></a>
    <span class="punctuation">}</span>
    <span class="keyword">catch</span> <span class="punctuation">(</span><span id="14803" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showErrorMessage</span><span class="punctuation">(</span><a href="actions.html#14880"><span class="member" data-toggle="tooltip" data-title="(error: unknown) =&gt; string">getMessage</span></a><span class="punctuation">(</span><a href="actions.html#14803"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>Dig out the error message from unknown error object.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="14880" class="member" data-toggle="tooltip" data-title="(error: unknown) =&gt; string">getMessage</span><span class="punctuation">(</span><span id="14969" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">:</span> <span class="keyword">unknown</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#14969"><span data-toggle="tooltip" data-title="unknown">error</span></a> <span class="keyword">instanceof</span> <span class="typename" data-toggle="tooltip" data-title="ErrorConstructor">Error</span> <span class="punctuation">?</span> <a href="actions.html#14969"><span data-toggle="tooltip" data-title="Error">error</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">message</span> <span class="punctuation">:</span>
        <a href="actions.html#14969"><span data-toggle="tooltip" data-title="unknown">error</span></a> <span class="keyword">instanceof</span> <span class="typename" data-toggle="tooltip" data-title="ObjectConstructor">Object</span> <span class="punctuation">?</span> <a href="actions.html#14969"><span data-toggle="tooltip" data-title="Object">error</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toString</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">:</span>
        <span class="keyword">typeof</span> <a href="actions.html#14969"><span data-toggle="tooltip" data-title="unknown">error</span></a> <span class="punctuation">==</span> <span class="string">&#039;string&#039;</span> <span class="punctuation">?</span> <a href="actions.html#14969"><span data-toggle="tooltip" data-title="string">error</span></a> <span class="punctuation">:</span> <span class="string">&quot;Unknown error&quot;</span>
<span class="punctuation">}</span>
</code></pre>
<p><code>evalString</code> function evaluates JavaScript expressions. Before doing so, it
defines some variables that can be used in the evaluated text.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">function</span> <span id="15156" class="member" data-toggle="tooltip" data-title="(str: string, __selecting: boolean) =&gt; any">evalString</span><span class="punctuation">(</span><span id="15337" data-toggle="tooltip" data-title="string">str</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span> <span id="15349" data-toggle="tooltip" data-title="boolean">__selecting</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">any</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="15387" data-toggle="tooltip" data-title="any">__file</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <span class="keyword">let</span> <span id="15415" data-toggle="tooltip" data-title="any">__line</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <span class="keyword">let</span> <span id="15443" data-toggle="tooltip" data-title="any">__col</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <span class="keyword">let</span> <span id="15470" data-toggle="tooltip" data-title="any">__char</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <span class="keyword">let</span> <span id="15498" data-toggle="tooltip" data-title="any">__selection</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="undefined">undefined</span>
    <span class="keyword">let</span> <span id="15531" data-toggle="tooltip" data-title="string[]">__keySequence</span> <span class="punctuation">=</span> <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a>
    <span class="keyword">let</span> <span id="15568" data-toggle="tooltip" data-title="string[]">__keys</span> <span class="punctuation">=</span> <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a>
    <span class="keyword">let</span> <span id="15598" data-toggle="tooltip" data-title="string[]">__rkeys</span> <span class="punctuation">=</span> <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(start?: number, end?: number) =&gt; string[]">slice</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string[]">reverse</span><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="15647" data-toggle="tooltip" data-title="string">__cmd</span> <span class="punctuation">=</span> <a href="actions.html#15568"><span data-toggle="tooltip" data-title="string[]">__keys</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&#039;&#039;</span><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="15680" data-toggle="tooltip" data-title="string">__rcmd</span> <span class="punctuation">=</span> <a href="actions.html#15598"><span data-toggle="tooltip" data-title="string[]">__rkeys</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&#039;&#039;</span><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="15715" data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span> <span class="punctuation">=</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">activeTextEditor</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#15715"><span data-toggle="tooltip" data-title="vscode.TextEditor | undefined">editor</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="15787" data-toggle="tooltip" data-title="vscode.Position">cursor</span> <span class="punctuation">=</span> <a href="actions.html#15715"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Position">active</span>
        <a href="actions.html#15387"><span data-toggle="tooltip" data-title="any">__file</span></a> <span class="punctuation">=</span> <a href="actions.html#15715"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span>
        <a href="actions.html#15415"><span data-toggle="tooltip" data-title="any">__line</span></a> <span class="punctuation">=</span> <a href="actions.html#15787"><span data-toggle="tooltip" data-title="vscode.Position">cursor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">line</span>
        <a href="actions.html#15443"><span data-toggle="tooltip" data-title="any">__col</span></a> <span class="punctuation">=</span> <a href="actions.html#15787"><span data-toggle="tooltip" data-title="vscode.Position">cursor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">character</span>
        <a href="actions.html#15470"><span data-toggle="tooltip" data-title="any">__char</span></a> <span class="punctuation">=</span> <a href="actions.html#15715"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><span class="keyword">new</span> <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof vscode.Range">Range</span><span class="punctuation">(</span><a href="actions.html#15787"><span data-toggle="tooltip" data-title="vscode.Position">cursor</span></a><span class="punctuation">,</span>
            <a href="actions.html#15787"><span data-toggle="tooltip" data-title="vscode.Position">cursor</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (lineDelta?: number, characterDelta?: number): vscode.Position; (change: { lineDelta?: number; characterDelta?: number; }): vscode.Position; }">translate</span><span class="punctuation">(</span><span class="punctuation">{</span> <span id="16026" data-toggle="tooltip" data-title="number">characterDelta</span><span class="punctuation">:</span> <span class="number">1</span> <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <a href="actions.html#15498"><span data-toggle="tooltip" data-title="any">__selection</span></a> <span class="punctuation">=</span> <a href="actions.html#15715"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.TextDocument">document</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(range?: vscode.Range) =&gt; string">getText</span><span class="punctuation">(</span><a href="actions.html#15715"><span data-toggle="tooltip" data-title="vscode.TextEditor">editor</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="vscode.Selection">selection</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">try</span> <span class="punctuation">{</span>
        <span class="keyword">return</span> <span class="member" data-toggle="tooltip" data-title="(x: string) =&gt; any">eval</span><span class="punctuation">(</span><span class="string">`(${</span><a href="actions.html#15337"><span data-toggle="tooltip" data-title="string">str</span></a><span class="string">})`</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">catch</span> <span class="punctuation">(</span><span id="16185" data-toggle="tooltip" data-title="unknown">error</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showErrorMessage</span><span class="punctuation">(</span><span class="string">&quot;Evaluation error: &quot;</span> <span class="punctuation">+</span> <a href="actions.html#14880"><span class="member" data-toggle="tooltip" data-title="(error: unknown) =&gt; string">getMessage</span></a><span class="punctuation">(</span><a href="actions.html#16185"><span data-toggle="tooltip" data-title="unknown">error</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>
<p>We need the evaluation function when executing conditional command. The
condition is evaluated and if a key is found that matches the result, it is
executed.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="16285" class="member" data-toggle="tooltip" data-title="(cond: Conditional, selecting: boolean) =&gt; Promise&lt;void&gt;">executeConditional</span><span class="punctuation">(</span><span id="16501" data-toggle="tooltip" data-title="Conditional">cond</span><span class="punctuation">:</span> <a href="actions.html#1052"><span class="typename" data-toggle="tooltip" data-title="Conditional">Conditional</span></a><span class="punctuation">,</span> <span id="16519" data-toggle="tooltip" data-title="boolean">selecting</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span><span class="punctuation">:</span>
    <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="16570" data-toggle="tooltip" data-title="any">res</span> <span class="punctuation">=</span> <a href="actions.html#15156"><span class="member" data-toggle="tooltip" data-title="(str: string, __selecting: boolean) =&gt; any">evalString</span></a><span class="punctuation">(</span><a href="actions.html#16501"><span data-toggle="tooltip" data-title="Conditional">cond</span></a><span class="punctuation">.</span><a href="actions.html#1301"><span data-toggle="tooltip" data-title="string">condition</span></a><span class="punctuation">,</span> <a href="actions.html#16519"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
    <span class="keyword">let</span> <span id="16623" data-toggle="tooltip" data-title="string">branch</span> <span class="punctuation">=</span> <a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#16570"><span data-toggle="tooltip" data-title="any">res</span></a><span class="punctuation">)</span> <span class="punctuation">?</span> <a href="actions.html#16570"><span data-toggle="tooltip" data-title="string">res</span></a> <span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="JSON">JSON</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (value: any, replacer?: (this: any, key: string, value: any) =&gt; any, space?: string | number): string; (value: any, replacer?: (number | string)[] | null, space?: string | number): string; }">stringify</span><span class="punctuation">(</span><a href="actions.html#16570"><span data-toggle="tooltip" data-title="any">res</span></a><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#16623"><span data-toggle="tooltip" data-title="string">branch</span></a> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#12291"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Action">isAction</span></a><span class="punctuation">(</span><a href="actions.html#16501"><span data-toggle="tooltip" data-title="Conditional">cond</span></a><span class="punctuation">[</span><a href="actions.html#16623"><span data-toggle="tooltip" data-title="string">branch</span></a><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="actions.html#18829"><span class="member" data-toggle="tooltip" data-title="(action: Action, selecting: boolean) =&gt; Promise&lt;void&gt;">execute</span></a><span class="punctuation">(</span><a href="actions.html#16501"><span data-toggle="tooltip" data-title="Conditional">cond</span></a><span class="punctuation">[</span><a href="actions.html#16623"><span data-toggle="tooltip" data-title="string">branch</span></a><span class="punctuation">]</span><span class="punctuation">,</span> <a href="actions.html#16519"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<p>Since repeated commands can potentially put VSCode in a busy loop, we provide
a way to abort them. For this purpose, we define a flag that is set by the
<code>enterNormalMode</code> function. Effectively, when the user presses <code>Esc</code> we abort
the repeat loop.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">let</span> <span id="17050" data-toggle="tooltip" data-title="boolean">abort</span> <span class="punctuation">=</span> <span class="keyword">false</span>
<span class="keyword">export</span> <span class="keyword">function</span> <span id="17064" class="member" data-toggle="tooltip" data-title="() =&gt; void">abortActions</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="actions.html#17050"><span data-toggle="tooltip" data-title="boolean">abort</span></a> <span class="punctuation">=</span> <span class="keyword">true</span>
<span class="punctuation">}</span>
</code></pre>
<p>Parameterized commands can get their arguments in two forms: as a string
that is evaluated to get the actual arguments, or as an object. Before
executing the command, we inspect the <code>repeat</code> property. If it is string
we evaluate it, and check if the result is a number. If so, we update the
<code>repeat</code> variable that designates repetition count. If not, we treate it as
a continue condition. The subroutine <code>exec</code> runs the command either <code>repeat</code>
times or as long as the expression in the <code>repeat</code> property returns a truthy
value.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="17119" class="member" data-toggle="tooltip" data-title="(action: Parameterized, selecting: boolean) =&gt; Promise&lt;void&gt;">executeParameterized</span><span class="punctuation">(</span><span id="17733" data-toggle="tooltip" data-title="Parameterized">action</span><span class="punctuation">:</span> <a href="actions.html#1358"><span class="typename" data-toggle="tooltip" data-title="Parameterized">Parameterized</span></a><span class="punctuation">,</span> <span id="17755" data-toggle="tooltip" data-title="boolean">selecting</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="17786" data-toggle="tooltip" data-title="string | number">repeat</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">number</span> <span class="punctuation">=</span> <span class="number">1</span>
    <span class="keyword">async</span> <span class="keyword">function</span> <span id="17814" class="member" data-toggle="tooltip" data-title="(args?: any) =&gt; Promise&lt;void&gt;">exec</span><span class="punctuation">(</span><span id="17840" data-toggle="tooltip" data-title="any">args</span><span class="punctuation">?</span><span class="punctuation">:</span> <span class="keyword">any</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="17866" data-toggle="tooltip" data-title="boolean">cont</span> <span class="punctuation">=</span> <span class="keyword">true</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#17786"><span data-toggle="tooltip" data-title="string | number">repeat</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
            <span class="keyword">do</span> <span class="punctuation">{</span>
                <span class="keyword">await</span> <a href="actions.html#14229"><span class="member" data-toggle="tooltip" data-title="(command: string, ...rest: any[]) =&gt; Promise&lt;void&gt;">executeVSCommand</span></a><span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2003"><span data-toggle="tooltip" data-title="string">command</span></a><span class="punctuation">,</span> <a href="actions.html#17840"><span data-toggle="tooltip" data-title="any">args</span></a><span class="punctuation">)</span>
                <a href="actions.html#17866"><span data-toggle="tooltip" data-title="boolean">cont</span></a> <span class="punctuation">=</span> <span class="punctuation">!</span><a href="actions.html#17050"><span data-toggle="tooltip" data-title="boolean">abort</span></a> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#15156"><span class="member" data-toggle="tooltip" data-title="(str: string, __selecting: boolean) =&gt; any">evalString</span></a><span class="punctuation">(</span><a href="actions.html#17786"><span data-toggle="tooltip" data-title="string">repeat</span></a><span class="punctuation">,</span> <a href="actions.html#17755"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
            <span class="punctuation">}</span>
            <span class="keyword">while</span> <span class="punctuation">(</span><a href="actions.html#17866"><span data-toggle="tooltip" data-title="boolean">cont</span></a><span class="punctuation">)</span>
        <span class="keyword">else</span>
            <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="18130" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">0</span><span class="punctuation">;</span> <a href="actions.html#18130"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;</span> <a href="actions.html#17786"><span data-toggle="tooltip" data-title="number">repeat</span></a> <span class="punctuation">&amp;&amp;</span> <span class="punctuation">!</span><a href="actions.html#17050"><span data-toggle="tooltip" data-title="boolean">abort</span></a><span class="punctuation">;</span> <a href="actions.html#18130"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span><span class="punctuation">)</span>
                <span class="keyword">await</span> <a href="actions.html#14229"><span class="member" data-toggle="tooltip" data-title="(command: string, ...rest: any[]) =&gt; Promise&lt;void&gt;">executeVSCommand</span></a><span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2003"><span data-toggle="tooltip" data-title="string">command</span></a><span class="punctuation">,</span> <a href="actions.html#17840"><span data-toggle="tooltip" data-title="any">args</span></a><span class="punctuation">)</span>
        <a href="actions.html#17050"><span data-toggle="tooltip" data-title="boolean">abort</span></a> <span class="punctuation">=</span> <span class="keyword">false</span>
    <span class="punctuation">}</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2048"><span data-toggle="tooltip" data-title="string | number | undefined">repeat</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2048"><span data-toggle="tooltip" data-title="string | number">repeat</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            <span class="keyword">let</span> <span id="18339" data-toggle="tooltip" data-title="any">val</span> <span class="punctuation">=</span> <a href="actions.html#15156"><span class="member" data-toggle="tooltip" data-title="(str: string, __selecting: boolean) =&gt; any">evalString</span></a><span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2048"><span data-toggle="tooltip" data-title="string">repeat</span></a><span class="punctuation">,</span> <a href="actions.html#17755"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="actions.html#18339"><span data-toggle="tooltip" data-title="any">val</span></a> <span class="punctuation">===</span> <span class="string">&#039;number&#039;</span><span class="punctuation">)</span>
                <a href="actions.html#17786"><span data-toggle="tooltip" data-title="string | number">repeat</span></a> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" data-title="Math">Math</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...values: number[]) =&gt; number">max</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <a href="actions.html#18339"><span data-toggle="tooltip" data-title="number">val</span></a><span class="punctuation">)</span>
            <span class="keyword">else</span>
                <a href="actions.html#17786"><span data-toggle="tooltip" data-title="string | number">repeat</span></a> <span class="punctuation">=</span> <a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2048"><span data-toggle="tooltip" data-title="string">repeat</span></a>
        <span class="punctuation">}</span>
        <span class="keyword">else</span>
            <a href="actions.html#17786"><span data-toggle="tooltip" data-title="string | number">repeat</span></a> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" data-title="Math">Math</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...values: number[]) =&gt; number">max</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2048"><span data-toggle="tooltip" data-title="number">repeat</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2024"><span data-toggle="tooltip" data-title="string | {} | undefined">args</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">typeof</span> <a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2024"><span data-toggle="tooltip" data-title="string | {}">args</span></a> <span class="punctuation">===</span> <span class="string">&#039;string&#039;</span><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="actions.html#17814"><span class="member" data-toggle="tooltip" data-title="(args?: any) =&gt; Promise&lt;void&gt;">exec</span></a><span class="punctuation">(</span><a href="actions.html#15156"><span class="member" data-toggle="tooltip" data-title="(str: string, __selecting: boolean) =&gt; any">evalString</span></a><span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2024"><span data-toggle="tooltip" data-title="string">args</span></a><span class="punctuation">,</span> <a href="actions.html#17755"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">else</span>
            <span class="keyword">await</span> <a href="actions.html#17814"><span class="member" data-toggle="tooltip" data-title="(args?: any) =&gt; Promise&lt;void&gt;">exec</span></a><span class="punctuation">(</span><a href="actions.html#17733"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">.</span><a href="actions.html#2024"><span data-toggle="tooltip" data-title="{}">args</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">else</span>
        <span class="keyword">await</span> <a href="actions.html#17814"><span class="member" data-toggle="tooltip" data-title="(args?: any) =&gt; Promise&lt;void&gt;">exec</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
<span class="punctuation">}</span>
</code></pre>
<h2 id="executing-actions">Executing Actions</h2>
<p>Before running any commands, we need to identify which type of action we got.
Depending on the type we use different function to execute the command. If
the action is not a command, it has to be a keymap. Since we resolved <code>id</code>
referenences in <code>validateAndResolveKeymaps</code>, an action has to be a keymap
object at this point. We set the new keymap as the active one.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">async</span> <span class="keyword">function</span> <span id="18829" class="member" data-toggle="tooltip" data-title="(action: Action, selecting: boolean) =&gt; Promise&lt;void&gt;">execute</span><span class="punctuation">(</span><span id="19281" data-toggle="tooltip" data-title="Action">action</span><span class="punctuation">:</span> <a href="actions.html#382"><span class="typename" data-toggle="tooltip" data-title="Action">Action</span></a><span class="punctuation">,</span> <span id="19296" data-toggle="tooltip" data-title="boolean">selecting</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">void</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a> <span class="punctuation">=</span> <span class="keyword">null</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#12673"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is string">isString</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="Action">action</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="actions.html#14229"><span class="member" data-toggle="tooltip" data-title="(command: string, ...rest: any[]) =&gt; Promise&lt;void&gt;">executeVSCommand</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="string">action</span></a><span class="punctuation">)</span>
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#13280"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Command[]">isCommandSequence</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="number | Conditional | Parameterized | Command[] | Keymap">action</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">const</span> <span id="19487" data-toggle="tooltip" data-title="Command">command</span> <span class="keyword">of</span> <a href="actions.html#19281"><span data-toggle="tooltip" data-title="Command[]">action</span></a><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="actions.html#18829"><span class="member" data-toggle="tooltip" data-title="(action: Action, selecting: boolean) =&gt; Promise&lt;void&gt;">execute</span></a><span class="punctuation">(</span><a href="actions.html#19487"><span data-toggle="tooltip" data-title="Command">command</span></a><span class="punctuation">,</span> <a href="actions.html#19296"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#13450"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Conditional">isConditional</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="number | Conditional | Parameterized | Keymap">action</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="actions.html#16285"><span class="member" data-toggle="tooltip" data-title="(cond: Conditional, selecting: boolean) =&gt; Promise&lt;void&gt;">executeConditional</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="Conditional">action</span></a><span class="punctuation">,</span> <a href="actions.html#19296"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#13701"><span class="member" data-toggle="tooltip" data-title="(x: any) =&gt; x is Parameterized">isParameterized</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="number | Parameterized | Keymap">action</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="actions.html#17119"><span class="member" data-toggle="tooltip" data-title="(action: Parameterized, selecting: boolean) =&gt; Promise&lt;void&gt;">executeParameterized</span></a><span class="punctuation">(</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="Parameterized">action</span></a><span class="punctuation">,</span> <a href="actions.html#19296"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
    <span class="keyword">else</span>
        <a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a> <span class="punctuation">=</span> <span class="punctuation">&lt;</span><a href="actions.html#2081"><span class="typename" data-toggle="tooltip" data-title="Keymap">Keymap</span></a><span class="punctuation">&gt;</span><a href="actions.html#19281"><span data-toggle="tooltip" data-title="number | Keymap">action</span></a>
<span class="punctuation">}</span>
</code></pre>
<h2 id="key-press-handler">Key Press Handler</h2>
<p>Now that the plumbing of actions is implemented, it is straightforward to
map the pressed key to an action. The special case occurs when a command
captures the keyboard. Then we rerun the previous command and give the key
to it as an argument.</p>
<p>Otherwise we just check if the current keymap contains binding for the key
pressed, and execute the action. If not, we present an error to the user.</p>
<p>As a last step the function returns <code>true</code>, if the current keymap is <code>null</code>.
This indicates that the key invoked a command instead of just changing the
active keymap.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span id="19790" class="member" data-toggle="tooltip" data-title="(key: string, selecting: boolean, capture: boolean) =&gt; Promise&lt;boolean&gt;">handleKey</span><span class="punctuation">(</span><span id="20472" data-toggle="tooltip" data-title="string">key</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span> <span id="20484" data-toggle="tooltip" data-title="boolean">selecting</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">,</span>
    <span id="20504" data-toggle="tooltip" data-title="boolean">capture</span><span class="punctuation">:</span> <span class="keyword">boolean</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Promise&lt;T&gt;">Promise</span><span class="punctuation">&lt;</span><span class="keyword">boolean</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>

    <span class="keyword">function</span> <span id="20547" class="member" data-toggle="tooltip" data-title="() =&gt; void">error</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#356"><span data-toggle="tooltip" data-title="typeof vscode">vscode</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="typeof vscode.window">window</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T extends string&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends string&gt;(message: string, options: vscode.MessageOptions, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: string, ...items: T[]): Thenable&lt;T | undefined&gt;; &lt;T extends vscode.MessageItem&gt;(message: ...">showWarningMessage</span><span class="punctuation">(</span><span class="string">&quot;ModalEdit: Undefined key binding: &quot;</span> <span class="punctuation">+</span>
            <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&quot; - &quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>
        <a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a> <span class="punctuation">=</span> <span class="keyword">null</span>
    <span class="punctuation">}</span>

    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <a href="actions.html#4936"><span data-toggle="tooltip" data-title="string[][]">keySeqStack</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[][]) =&gt; number">push</span><span class="punctuation">(</span><a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a><span class="punctuation">)</span>
        <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
    <span class="punctuation">}</span>
    <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">)</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#20504"><span data-toggle="tooltip" data-title="boolean">capture</span></a> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#4527"><span data-toggle="tooltip" data-title="string">lastCommand</span></a><span class="punctuation">)</span>
        <span class="keyword">await</span> <a href="actions.html#14229"><span class="member" data-toggle="tooltip" data-title="(command: string, ...rest: any[]) =&gt; Promise&lt;void&gt;">executeVSCommand</span></a><span class="punctuation">(</span><a href="actions.html#4527"><span data-toggle="tooltip" data-title="string">lastCommand</span></a><span class="punctuation">,</span> <a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">)</span>
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap">currentKeymap</span></a><span class="punctuation">[</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="actions.html#18829"><span class="member" data-toggle="tooltip" data-title="(action: Action, selecting: boolean) =&gt; Promise&lt;void&gt;">execute</span></a><span class="punctuation">(</span><a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap">currentKeymap</span></a><span class="punctuation">[</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">,</span> <a href="actions.html#20484"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
        <span class="keyword">else</span>
            <a href="actions.html#20547"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">error</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">else</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#20484"><span data-toggle="tooltip" data-title="boolean">selecting</span></a> <span class="punctuation">&amp;&amp;</span> <a href="actions.html#4209"><span data-toggle="tooltip" data-title="Keymap">selectKeymap</span></a><span class="punctuation">[</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="actions.html#18829"><span class="member" data-toggle="tooltip" data-title="(action: Action, selecting: boolean) =&gt; Promise&lt;void&gt;">execute</span></a><span class="punctuation">(</span><a href="actions.html#4209"><span data-toggle="tooltip" data-title="Keymap">selectKeymap</span></a><span class="punctuation">[</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">,</span> <a href="actions.html#20484"><span data-toggle="tooltip" data-title="true">selecting</span></a><span class="punctuation">)</span>
        <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><a href="actions.html#4185"><span data-toggle="tooltip" data-title="Keymap">baseKeymap</span></a><span class="punctuation">[</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">)</span>
            <span class="keyword">await</span> <a href="actions.html#18829"><span class="member" data-toggle="tooltip" data-title="(action: Action, selecting: boolean) =&gt; Promise&lt;void&gt;">execute</span></a><span class="punctuation">(</span><a href="actions.html#4185"><span data-toggle="tooltip" data-title="Keymap">baseKeymap</span></a><span class="punctuation">[</span><a href="actions.html#20472"><span data-toggle="tooltip" data-title="string">key</span></a><span class="punctuation">]</span><span class="punctuation">,</span> <a href="actions.html#20484"><span data-toggle="tooltip" data-title="boolean">selecting</span></a><span class="punctuation">)</span>
        <span class="keyword">else</span>
            <a href="actions.html#20547"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">error</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
    <span class="punctuation">}</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a><span class="punctuation">)</span>
        <a href="actions.html#4904"><span data-toggle="tooltip" data-title="string[]">keySequence</span></a> <span class="punctuation">=</span> <a href="actions.html#4936"><span data-toggle="tooltip" data-title="string[][]">keySeqStack</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string[] | undefined">pop</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">!</span>
    <span class="keyword">return</span> <span class="punctuation">!</span><a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a>
<span class="punctuation">}</span>
</code></pre>
<h2 id="keymap-help">Keymap Help</h2>
<p>When defining complex key sequences you can help the user by defining what
keys she can press next and what they do. If the help is defined, it is shown
in the status bar.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">export</span> <span class="keyword">function</span> <span id="21447" class="member" data-toggle="tooltip" data-title="() =&gt; string | undefined">getHelp</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">|</span> <span class="keyword">undefined</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="actions.html#4372"><span data-toggle="tooltip" data-title="Keymap | null">currentKeymap</span></a><span class="punctuation">?.</span><a href="actions.html#2949"><span data-toggle="tooltip" data-title="string | undefined">help</span></a>
<span class="punctuation">}</span>
</code></pre>

        </div>
            <div class="sidepane narrow-scrollbars">
                
        <div class="pagemenu">
            <h3>On This Page</h3>
                <ul class="pagetree">
                </ul>
        </div>
            </div>
        </div>
        
        <div class="footer">
            <a class="footer-button" href="extension.html">
            <p>Previous</p>
            <p>« Extension</p>
        </a>
            <div class="footer-text">
                <p>Copyright © 2025 Tommi Johtela</p>
                <p>Generated by 
                    <a href="https://johtela.github.io/litscript">LiTScript</a>
                </p>
            </div>
            <a class="footer-button" href="commands.html">
            <p>Next</p>
            <p>Commands »</p>
        </a>
        </div>
    
        <script src="../dist/normal.js"></script>
    </body>
    </html>